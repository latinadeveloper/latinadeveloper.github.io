<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Active Record Basics — Ruby on Rails Guides</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="stylesheets/prism/default.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/prism/rails-guides.css" data-turbolinks-track="reload">
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  <script src="javascripts/prism.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/turbolinks.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/guides.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/responsive-tables.js" data-turbolinks-track="reload"></script>
  <meta property="og:title" content="Active Record Basics — Ruby on Rails Guides" />
  <meta name="description" content="NO LEA ESTE ARCHIVO EN GITHUB, LAS GUÍAS SE PUBLICAN EN https://guides.rubyonrails.org.Active Record BasicsLo esencial de Active RecordEsta guía es una introducción a Active Record.Después de leer esta guía, sabrá: Qué son el mapeo relacional de objetos y el registro activo y cómo se usan en Rails. Cómo Active Record encaja en el paradigma Modelo-Vista-Controlador. Cómo usar los modelos de Active Record para manipular los datos almacenados en una relación base de datos. Convenciones de nomenclatura del esquema de registro activo. Los conceptos de migraciones de bases de datos, validaciones y devoluciones de llamadas." />
  <meta property="og:description" content="NO LEA ESTE ARCHIVO EN GITHUB, LAS GUÍAS SE PUBLICAN EN https://guides.rubyonrails.org.Active Record BasicsLo esencial de Active RecordEsta guía es una introducción a Active Record.Después de leer esta guía, sabrá: Qué son el mapeo relacional de objetos y el registro activo y cómo se usan en Rails. Cómo Active Record encaja en el paradigma Modelo-Vista-Controlador. Cómo usar los modelos de Active Record para manipular los datos almacenados en una relación base de datos. Convenciones de nomenclatura del esquema de registro activo. Los conceptos de migraciones de bases de datos, validaciones y devoluciones de llamadas." />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="Ruby on Rails Guides" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
  <meta property="og:type" content="website" />
</head>
<body class="guide">
  <div>
<!--    <img src="images/edge_badge.png" alt="edge-badge" id="edge-badge" />-->
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">Más en <a href="https://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        Más Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://weblog.rubyonrails.org/">Blog</a></li>
        <li class="more-info"><a href="https://guides.rubyonrails.org/">Guías</a></li>
        <li class="more-info"><a href="https://api.rubyonrails.org/">API</a></li>
        <li class="more-info"><a href="https://stackoverflow.com/questions/tagged/ruby-on-rails">Pedir Ayuda</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">Contribuir on GitHub</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Guías de Ruby on Rails">Guías de Ruby on Rails </a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Inicio</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">Index de Guías </a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="guides-section-container">
                <div class="guides-section">
                  <dt>Empieza Aqui</dt>
                  <dd><a href="getting_started.html">Introducción a Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Modelos</dt>
                  <dd><a href="active_record_basics.html">Conceptos básicos de Active Record</a></dd>
                  <dd><a href="active_record_migrations.html">Migraciones de Active Record</a></dd>
                  <dd><a href="active_record_validations.html">Validaciones de Active Record</a></dd>
                  <dd><a href="active_record_callbacks.html">Devolución (callbacks) de Llamadas de Active Record</a></dd>
                  <dd><a href="association_basics.html">Asociaciones de Active Record</a></dd>
                  <dd><a href="active_record_querying.html">Interfaz de Consulta de Active Record</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Vistas</dt>
                  <dd><a href="layouts_and_rendering.html">Diseños y Renderizado en Rails</a></dd>
                  <dd><a href="form_helpers.html">Ayudantes de Formulario de Action</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Controladores</dt>
                  <dd><a href="action_controller_overview.html">Descripción General de Action Controller</a></dd>
                  <dd><a href="routing.html">Rails Routing Desde el Exterior Hacia Adentro</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Otros Componentes</dt>
                  <dd><a href="active_support_core_extensions.html">Extensiones de Núcleo de Active Support</a></dd>
                  <dd><a href="action_mailer_basics.html">Conceptos Básicos de Action Mailer</a></dd>
                  <dd><a href="active_job_basics.html">Conceptos Básicos de Active Job</a></dd>
                  <dd><a href="active_storage_overview.html">Descripción General de Active Storage</a></dd>
                  <dd><a href="action_cable_overview.html">Descripción General de Action Cable</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Temas Avanzados</dt>
                  <dd><a href="i18n.html">Rails API de Internacionalización (I18n)</a></dd>
                  <dd><a href="testing.html">Prueba de Aplicaciones de Rails</a></dd>
                  <dd><a href="security.html">Seguridad de Aplicaciones Rails</a></dd>
                  <dd><a href="debugging_rails_applications.html">Depuración de Applications Rails</a></dd>
                  <dd><a href="configuring.html">Configuración de Aplicaciones de Rails</a></dd>
                  <dd><a href="command_line.html">La Línea de Comandos de Rails</a></dd>
                  <dd><a href="asset_pipeline.html">The Asset Pipeline (necesita traducción)</a></dd>
                  <dd><a href="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants (Zeitwerk Mode) (necesita traducción)</a></dd>
                  <dd><a href="autoloading_and_reloading_constants_classic_mode.html">Autoloading and Reloading Constants (Classic Mode) (necesita traducción)</a></dd>
                  <dd><a href="caching_with_rails.html">Caching with Rails An Overview (necesita traducción)</a></dd>
                  <dd><a href="api_app.html">Using Rails for API-only Applications (necesita traducción)</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Extending Rails  (toda la sección necesita traducción)</dt>
                  <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
                  <dd><a href="generators.html">Creating and Customizing Rails Generators &amp; Templates</a></dd>
                </div>
            </dl>
          </div>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">Contribuir</a></li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">Guides Index</option>
              <optgroup label="Empieza Aqui">
                  <option value="getting_started.html">Introducción a Rails</option>
              </optgroup>
              <optgroup label="Modelos">
                  <option value="active_record_basics.html">Conceptos básicos de Active Record</option>
                  <option value="active_record_migrations.html">Migraciones de Active Record</option>
                  <option value="active_record_validations.html">Validaciones de Active Record</option>
                  <option value="active_record_callbacks.html">Devolución (callbacks) de Llamadas de Active Record</option>
                  <option value="association_basics.html">Asociaciones de Active Record</option>
                  <option value="active_record_querying.html">Interfaz de Consulta de Active Record</option>
              </optgroup>
              <optgroup label="Vistas">
                  <option value="layouts_and_rendering.html">Diseños y Renderizado en Rails</option>
                  <option value="form_helpers.html">Ayudantes de Formulario de Action</option>
              </optgroup>
              <optgroup label="Controladores">
                  <option value="action_controller_overview.html">Descripción General de Action Controller</option>
                  <option value="routing.html">Rails Routing Desde el Exterior Hacia Adentro</option>
              </optgroup>
              <optgroup label="Otros Componentes">
                  <option value="active_support_core_extensions.html">Extensiones de Núcleo de Active Support</option>
                  <option value="action_mailer_basics.html">Conceptos Básicos de Action Mailer</option>
                  <option value="active_job_basics.html">Conceptos Básicos de Active Job</option>
                  <option value="active_storage_overview.html">Descripción General de Active Storage</option>
                  <option value="action_cable_overview.html">Descripción General de Action Cable</option>
              </optgroup>
              <optgroup label="Temas Avanzados">
                  <option value="i18n.html">Rails API de Internacionalización (I18n)</option>
                  <option value="testing.html">Prueba de Aplicaciones de Rails</option>
                  <option value="security.html">Seguridad de Aplicaciones Rails</option>
                  <option value="debugging_rails_applications.html">Depuración de Applications Rails</option>
                  <option value="configuring.html">Configuración de Aplicaciones de Rails</option>
                  <option value="command_line.html">La Línea de Comandos de Rails</option>
                  <option value="asset_pipeline.html">The Asset Pipeline (necesita traducción)</option>
                  <option value="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants (Zeitwerk Mode) (necesita traducción)</option>
                  <option value="autoloading_and_reloading_constants_classic_mode.html">Autoloading and Reloading Constants (Classic Mode) (necesita traducción)</option>
                  <option value="caching_with_rails.html">Caching with Rails An Overview (necesita traducción)</option>
                  <option value="api_app.html">Using Rails for API-only Applications (necesita traducción)</option>
              </optgroup>
              <optgroup label="Extending Rails  (toda la sección necesita traducción)">
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators &amp; Templates</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <p><strong>NO LEA ESTE ARCHIVO EN GITHUB, LAS GUÍAS SE PUBLICAN EN <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p><h2>Active Record Basics</h2><p>Lo esencial de Active Record</p><p>Esta guía es una introducción a Active Record.</p><p>Después de leer esta guía, sabrá:</p>
<ul>
<li>Qué son el mapeo relacional de objetos y el registro activo y cómo se usan en
  Rails.</li>
<li>Cómo Active Record encaja en el paradigma Modelo-Vista-Controlador.</li>
<li>Cómo usar los modelos de Active Record para manipular los datos almacenados en una relación
  base de datos.</li>
<li>Convenciones de nomenclatura del esquema de registro activo.</li>
<li>Los conceptos de migraciones de bases de datos, validaciones y devoluciones de llamadas.</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li>
<a href="#what-is-active-record-questionmark">What is Active Record?</a>

<ul>
<li><a href="#the-active-record-pattern">The Active Record Pattern</a></li>
<li><a href="#object-relational-mapping">Object Relational Mapping</a></li>
<li><a href="#active-record-as-an-orm-framework">Active Record as an ORM Framework</a></li>
</ul>
</li>
<li>
<a href="#convention-over-configuration-in-active-record">Convention over Configuration in Active Record</a>

<ul>
<li><a href="#naming-conventions">Naming Conventions</a></li>
<li><a href="#schema-conventions">Schema Conventions</a></li>
</ul>
</li>
<li><a href="#creating-active-record-models">Creating Active Record Models</a></li>
<li><a href="#overriding-the-naming-conventions">Overriding the Naming Conventions</a></li>
<li>
<a href="#crud-reading-and-writing-data">CRUD: Reading and Writing Data</a>

<ul>
<li><a href="#create">Create</a></li>
<li><a href="#read">Read</a></li>
<li><a href="#update">Update</a></li>
<li><a href="#delete">Delete</a></li>
</ul>
</li>
<li><a href="#validations">Validations</a></li>
<li><a href="#callbacks">Callbacks</a></li>
<li><a href="#migrations">Migrations</a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="what-is-active-record-questionmark"><a class="anchorlink" href="#what-is-active-record-questionmark">1 What is Active Record?</a></h3><p>¿Qué es Active Record?</p><p>Active Record es la M en <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> - el
modelo - que es la capa del sistema responsable de representar a las empresas
datos y lógica. Active Record facilita la creación y el uso de objetos de negocios
cuyos datos requieren almacenamiento persistente en una base de datos. Es un
implementación del patrón Active Record, que en sí mismo es una descripción de un
Sistema de Mapeo Relacional de Objetos.</p><h4 id="the-active-record-pattern"><a class="anchorlink" href="#the-active-record-pattern">1.1 The Active Record Pattern</a></h4><p>El patrón de Active Record</p><p><a href="https://www.martinfowler.com/eaaCatalog/activeRecord.html">Active Record fue descrito por Martin Fowler</a>
en su libro <em>Patterns of Enterprise Application Architecture</em>. En
Active Record, los objetos llevan datos persistentes y comportamiento que
opera con esos datos. Active Record considera que garantizar
la lógica de acceso a datos como parte del objeto educará a los usuarios de ese
objeto sobre cómo escribir y leer de la base de datos.</p><h4 id="object-relational-mapping"><a class="anchorlink" href="#object-relational-mapping">1.2 Object Relational Mapping</a></h4><p>Mapeo Relacional de Objetos</p><p><a href="https://en.wikipedia.org/wiki/Object-relational_mapping">Mapeo relacional de objetos</a>, comúnmente conocido como su abreviatura ORM, es
Una técnica que conecta los objetos ricos de una aplicación a tablas en
un sistema de gestión de bases de datos relacionales. Usando ORM, las propiedades y
Las relaciones de los objetos en una aplicación pueden almacenarse fácilmente y
recuperado de una base de datos sin escribir sentencias SQL directamente y con menos
código general de acceso a la base de datos.</p><p>NOTA: El conocimiento básico de los sistemas de gestión de bases de datos relacionales (RDBMS) y el lenguaje de consulta estructurado (SQL) es útil para comprender completamente Active Record. Consulte <a href="https://www.w3schools.com/sql/default.asp">este tutorial</a> (o <a href="http://www.sqlcourse.com/">este</a>) o estudíelos por otros medios si te gustaría aprender más.</p><h4 id="active-record-as-an-orm-framework"><a class="anchorlink" href="#active-record-as-an-orm-framework">1.3 Active Record as an ORM Framework</a></h4><p>Active Record como marco de referencia ORM</p><p>Active Record nos brinda varios mecanismos, el más importante es la habilidad
a:</p>
<ul>
<li>Representar modelos y sus datos.</li>
<li>Representar asociaciones entre estos modelos.</li>
<li>Representar jerarquías de herencia a través de modelos relacionados.</li>
<li>Valide los modelos antes de que persistan en la base de datos.</li>
<li>Realizar operaciones de base de datos de manera orientada a objetos.</li>
</ul>
<h3 id="convention-over-configuration-in-active-record"><a class="anchorlink" href="#convention-over-configuration-in-active-record">2 Convention over Configuration in Active Record</a></h3><p>Convención sobre configuración en Active Record</p><p>Al escribir aplicaciones utilizando otros lenguajes de programación o marcos,
puede ser necesario escribir mucho código de configuración. Esto es particularmente cierto
para marcos ORM en general. Sin embargo, si sigue las convenciones adoptadas por
Rails, necesitará escribir muy poca configuración (en algunos casos no
configuración en absoluto) al crear modelos Active Record. La idea es que si
configura sus aplicaciones de la misma manera la mayor parte del tiempo, entonces esto
debería ser la forma predeterminada. Por lo tanto, se necesitaría una configuración explícita
solo en aquellos casos en los que no puede seguir la convención estándar.</p><h4 id="naming-conventions"><a class="anchorlink" href="#naming-conventions">2.1 Naming Conventions</a></h4><p>Convenciones de nombres</p><p>De forma predeterminada, Active Record utiliza algunas convenciones de nomenclatura para averiguar cómo
Se debe crear un mapeo entre modelos y tablas de bases de datos. Rails
pluraliza los nombres de sus clases para encontrar la tabla de base de datos respectiva. Entonces, para
una clase <code>Book</code>, debe tener una tabla de base de datos llamada <strong>books</strong>. Los mecanismos 
de pluralización de Rails son muy potentes, capaces de pluralizar (y
singularizar) palabras regulares e irregulares. Cuando se usan nombres de clase compuestos
de dos o más palabras, el nombre de la clase modelo debe seguir las convenciones de Ruby,
usando el formulario CajaCamello, mientras que el nombre de la tabla debe contener las palabras separadas
por guiones bajos. Ejemplos:</p>
<ul>
<li>Clase de modelo - Singular con la primera letra de cada palabra en mayúscula (p.ej.,
<code>BookClub</code>).</li>
<li>Tabla de base de datos - Plural con guiones bajos que separan las palabras (p.ej., <code>book_clubs</code>).</li>
</ul>

<table>
<thead>
<tr>
<th>Modelo / Clase</th>
<th>Tabla / Esquema</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Article</code></td>
<td><code>articles</code></td>
</tr>
<tr>
<td><code>LineItem</code></td>
<td><code>line_items</code></td>
</tr>
<tr>
<td><code>Deer</code></td>
<td><code>deers</code></td>
</tr>
<tr>
<td><code>Mouse</code></td>
<td><code>mice</code></td>
</tr>
<tr>
<td><code>Person</code></td>
<td><code>people</code></td>
</tr>
</tbody>
</table>
<h4 id="schema-conventions"><a class="anchorlink" href="#schema-conventions">2.2 Schema Conventions</a></h4><p>Convenciones de Esquema</p><p>Active Record utiliza convenciones de nomenclatura para las columnas en las tablas de la base de datos,
dependiendo del propósito de estas columnas.</p>
<ul>
<li>
<strong>Claves foráneas</strong>: Estos campos deben nombrarse siguiendo el patrón
  <code>nombre_de_tabla_singularizada_id</code> (p.ej.,<code>item_id</code>, <code>order_id</code>). Estos son los
  campos que Active Record buscará cuando cree asociaciones entre
  sus modelos</li>
<li>
<strong>Claves primarias</strong> - Por defecto, Active Record usará una columna entera llamada
  <code>id</code> como clave principal de la tabla (<code>bigint</code> para PostgreSQL y MySQL, <code>integer</code>
  para SQLite). Cuando se utiliza <a href="active_record_migrations.html">Migraciones de registros activos</a>
  Para crear sus tablas, esta columna se creará automáticamente.</li>
</ul>
<p>También hay algunos nombres de columna opcionales que agregarán características adicionales
a instancias de Active Record:</p>
<ul>
<li>
<code>created_at</code> - Se establece automáticamente en la fecha y hora actuales cuando
  el registro se crea por primera vez.</li>
<li>
<code>updated_at</code> - Se establece automáticamente en la fecha y hora actuales siempre que
  El registro se crea o actualiza.</li>
<li>
<code>lock_version</code> - Agrega <a href="https://edgeapi.rubyonrails.org/classes/ActiveRecord/Locking.html">optimistic
locking</a> para
  un modelo.</li>
<li>
<code>type</code> - Especifica que el modelo usa <a href="https://edgeapi.rubyonrails.org/classes/ActiveRecord/Base.html#class-ActiveRecord::Base-label-Single+table+inheritance">Single Table
  Inheritance</a>.</li>
<li>
<code>(nombre_ asociación) _type</code> - Almacena el tipo para
  <a href="association_basics.html%20#%20polymorphic-asociaciones">asociaciones polimórficas</a>.</li>
<li>
<code>(table_name)_count</code> - Se usa para almacenar en caché el número de objetos pertenecientes en
  asociaciones. Por ejemplo, una columna <code>comments_count</code> en una clase<code>Article</code> que
  tiene muchas instancias de <code>Comentario</code> almacenará en caché el número de comentarios existentes
  para cada artículo.</li>
</ul>
<p>NOTA: Si bien estos nombres de columna son opcionales, de hecho están reservados por Active Record. Manténgase alejado de las palabras clave reservadas a menos que desee la funcionalidad adicional. Por ejemplo, <code>type</code> es una palabra clave reservada que se usa para designar una tabla usando la herencia de tabla única (Singel Table Inheritance). Si no está utilizando STI, intente con una palabra clave análoga como "contexto", que aún puede describir con precisión los datos que está modelando.</p><h3 id="creating-active-record-models"><a class="anchorlink" href="#creating-active-record-models">3 Creating Active Record Models</a></h3><p>Crear modelos de Active Record</p><p>Para crear modelos de Active Record, subclasifique la clase <code>ApplicationRecord</code> y estará listo:</p><div class="code_container">
<pre><code class="language-ruby">class Product &lt; ApplicationRecord
end
</code></pre>
</div>
<p>Esto creará un modelo de <code>Producto</code>, mapeado a una tabla de<code>productos</code> en
base de datos. Al hacer esto, también tendrá la capacidad de mapear las columnas de cada
fila en esa tabla con los atributos de las instancias de su modelo. Suponer
que la tabla <code>productos</code> fue creada usando una declaración SQL (o una de sus extensiones) como:</p><div class="code_container">
<pre><code class="language-sql">CREATE TABLE products (
   id int(11) NOT NULL auto_increment,
   name varchar(255),
   PRIMARY KEY  (id)
);
</code></pre>
</div>
<p>El esquema anterior declara una tabla con dos columnas: <code>id</code> y<code>name</code>. Cada fila de
Esta tabla representa un determinado producto con estos dos parámetros. Por lo tanto, usted
sería capaz de escribir código como el siguiente:</p><div class="code_container">
<pre><code class="language-ruby">p = Product.new
p.name = "Some Book"
puts p.name # "Some Book"
</code></pre>
</div>
<h3 id="overriding-the-naming-conventions"><a class="anchorlink" href="#overriding-the-naming-conventions">4 Overriding the Naming Conventions</a></h3><p>Anulación de las convenciones de nomenclatura</p><p>¿Qué sucede si necesita seguir una convención de nomenclatura diferente o si necesita usar su
Aplicación Rails con una base de datos heredada? No hay problema, puedes anular fácilmente
Las convenciones predeterminadas.</p><p><code>ApplicationRecord</code> hereda de<code>ActiveRecord :: Base</code>, que define un
Número de métodos útiles. Puede usar el <code>ActiveRecord :: Base.table_name =</code>
Método para especificar el nombre de la tabla que se debe utilizar:</p><div class="code_container">
<pre><code class="language-ruby">class Product &lt; ApplicationRecord
  self.table_name = "my_products"
end
</code></pre>
</div>
<p>Si lo hace, tendrá que definir manualmente el nombre de la clase que aloja
los accesorios (my_products.yml) usando el método <code>set_fixture_class</code> en su prueba
definición:</p><div class="code_container">
<pre><code class="language-ruby">class ProductTest &lt; ActiveSupport::TestCase
  set_fixture_class my_products: Product
  fixtures :my_products
  ...
end
</code></pre>
</div>
<p>También es posible anular la columna que se debe usar como tabla
clave primaria usando el método <code>ActiveRecord :: Base.primary_key =</code>: método</p><div class="code_container">
<pre><code class="language-ruby">class Product &lt; ApplicationRecord
  self.primary_key = "product_id"
end
</code></pre>
</div>
<p>NOTA: Active Record no admite el uso de columnas de clave no primaria llamadas <code>id</code>.</p><h3 id="crud-reading-and-writing-data"><a class="anchorlink" href="#crud-reading-and-writing-data">5 CRUD: Reading and Writing Data</a></h3><p>CRUD: lectura y escritura de datos</p><p>CRUD es un acrónimo de los cuatro verbos que usamos para operar con datos: <strong>C</strong>reate,
<strong>R</strong>ead, <strong>U</strong>pdate and <strong>D</strong>elete. Active Record crea automáticamente métodos
para permitir que una aplicación lea y manipule datos almacenados dentro de sus tablas.</p><h4 id="create"><a class="anchorlink" href="#create">5.1 Create</a></h4><p>Los objetos Active Record se pueden crear a partir de un hash, un bloque o tener su
atributos establecidos manualmente después de la creación. El método <code>new</code> devolverá un nuevo
object mientras que <code>create</code> devolverá el objeto y lo guardará en la base de datos.</p><p>Por ejemplo, dado un modelo <code>Usuario</code> con atributos de<code>nombre</code> y <code>ocupación</code>,
la llamada al método <code>create</code> creará y guardará un nuevo registro en la base de datos:</p><div class="code_container">
<pre><code class="language-ruby">user = User.create(name: "David", occupation: "Code Artist")
</code></pre>
</div>
<p>Usando el método <code>new</code>, un objeto puede ser instanciado sin ser guardado:</p><div class="code_container">
<pre><code class="language-ruby">user = User.new
user.name = "David"
user.occupation = "Code Artist"
</code></pre>
</div>
<p>Una llamada a <code>user.save</code> confirmará el registro en la base de datos.</p><p>Finalmente, si un bloque es proveído, tanto <code>create</code> como<code>new</code> producirá el nuevo
inicializado dentro de un bloque:</p><div class="code_container">
<pre><code class="language-ruby">user = User.new do |u|
  u.name = "David"
  u.occupation = "Code Artist"
end
</code></pre>
</div>
<h4 id="read"><a class="anchorlink" href="#read">5.2 Read</a></h4><p>Active Record provee una rica API para acceder a datos dentro de una base de datos. De abajo
son algunos ejemplos de diferentes métodos de acceso a datos por Active Record.</p><div class="code_container">
<pre><code class="language-ruby">#  devuelve una colección de usuarios
users = User.all
</code></pre>
</div>
<div class="code_container">
<pre><code class="language-ruby"># devuelve el primer usuario
user = User.first
</code></pre>
</div>
<div class="code_container">
<pre><code class="language-ruby"># devuelve el primer usuario llamado David
david = User.find_by(name: 'David')
</code></pre>
</div>
<div class="code_container">
<pre><code class="language-ruby"># encontrar todos los usuarios llamados David que tienen de ocupación Code Artists y ordenado por created_at en sentido cronológicamente inverso
users = User.where(name: 'David', occupation: 'Code Artist').order(created_at: :desc)
</code></pre>
</div>
<p>Puedes aprender más acerca de consultar un modelo Active Record en la guía <a href="active_record_querying.html">Active Record
Query Interface</a>.</p><h4 id="update"><a class="anchorlink" href="#update">5.3 Update</a></h4><p>Una vez que un objeto Active Record ha sido recuperado, sus atributos pueden ser modificados 
y volver a ser guardados en la base de datos.</p><div class="code_container">
<pre><code class="language-ruby">user = User.find_by(name: 'David')
user.name = 'Dave'
user.save
</code></pre>
</div>
<p>Una forma abreviada de esto es usar un nombre de atributo de mapeo hash para el deseado
valor, así:</p><div class="code_container">
<pre><code class="language-ruby">user = User.find_by(name: 'David')
user.update(name: 'Dave')
</code></pre>
</div>
<p>Esta es la manera más útil al actualizar varios atributos a la vez. Si, por otro lado, 
quieres actualizar varios a la vez, encontrarás muy útil el método <code>update_all</code>:</p><div class="code_container">
<pre><code class="language-ruby">User.update_all "max_login_attempts = 3, must_change_password = 'true'"
</code></pre>
</div>
<h4 id="delete"><a class="anchorlink" href="#delete">5.4 Delete</a></h4><p>Asimismo, una vez que se recupera el objeto Active Record también puede ser destruído,
lo cual lo borrará de la base de datos.</p><div class="code_container">
<pre><code class="language-ruby">user = User.find_by(name: 'David')
user.destroy
</code></pre>
</div>
<p>Si desea eliminar varios registros de forma masiva, puede usar el método <code>destroy_by</code> 
o <code>destroy_all</code>.</p><div class="code_container">
<pre><code class="language-ruby"># encontrar y destruir todos los usuarios llamados David
User.destroy_by(name: 'David')

# destruir todos los usuarios
User.destroy_all
</code></pre>
</div>
<h3 id="validations"><a class="anchorlink" href="#validations">6 Validations</a></h3><p>Validaciones</p><p>Active Record le permite validar el estado de un modelo antes de que se escriba
en la base de datos. Existen varios métodos que puede utilizar para verificar su
modelos y validar que un valor de atributo no está vacío, es único y no
ya en la base de datos, sigue un formato específico y muchos más.</p><p>La validación es un tema muy importante a considerar cuando se persiste en la base de datos, por lo que
los métodos <code>save</code> y<code>update</code> lo toman en cuenta cuando
se ejecutan: return <code>false</code> cuando una validación falla y no mantuvieron ninguna
operación en la base de datos. Todos estos tienen una contraparte explosiva, bang (que
es, <code>save!</code> y <code>update!</code>), que son más estrictos en ese sentido 
y arrojan una excepción <code>ActiveRecord::RecordInvalid</code> si la validación falla.
Un rápido ejemplo para ilustrar:</p><div class="code_container">
<pre><code class="language-ruby">class User &lt; ApplicationRecord
  validates :name, presence: true
end

user = User.new
user.save  # =&gt; false
user.save! # =&gt; ActiveRecord::RecordInvalid: Validation failed: Name can't be blank
</code></pre>
</div>
<p>Puedes aprender más acerca de validaciones en la guía <a href="active_record_validations.html">Active Record Validations
guide</a>.</p><h3 id="callbacks"><a class="anchorlink" href="#callbacks">7 Callbacks</a></h3><p>Las retrollamadas (callbacks) de Active Record le permiten adjuntar código a ciertos eventos en el
ciclo de vida de sus modelos. Esto le permite añadir comportamiento a sus modelos 
de forma transparente en la ejecución cuando estos eventos ocurren, como cuando se crea un nuevo
registro, actualizarlo, destruírlo, etc. Puedes obtener más información sobre las retrollamadas en
la <a href="active_record_callbacks.html">Active Record Callbacks guide</a>.</p><h3 id="migrations"><a class="anchorlink" href="#migrations">8 Migrations</a></h3><p>Rails provee un lenguaje de dominio específico para manejar un esquema de base de datos llamado
migraciones (migrations). Las migraciones son ficheros guardados que se ejecutan contra cualquier 
base de datos que Active Record soporte utilizando <code>rake</code>. Aquí hay una migración que 
crea una tabla:</p><div class="code_container">
<pre><code class="language-ruby">class CreatePublications &lt; ActiveRecord::Migration[6.0]
  def change
    create_table :publications do |t|
      t.string :title
      t.text :description
      t.references :publication_type
      t.integer :publisher_id
      t.string :publisher_type
      t.boolean :single_issue

      t.timestamps
    end
    add_index :publications, :publication_type_id
  end
end
</code></pre>
</div>
<p>Rails mantiene el historial sobre que fichero fue actualizado en la base de datos y 
provee características para deshacer los cambios. Para realmente crear la tabla, deberías ejecutar 
<code>bin/rails db:migrate</code> y para deshacerlo <code>bin/rails db:rollback</code>.</p><p>Nota que el código de arriba es database-agnostic: se puede ejectuar en MySQL, 
PostgreSQL, Oracle y others. Puedes aprender más acerca de las migraciones en
<a href="active_record_migrations.html">Active Record Migrations guide</a>.</p>

        <h3>Comentarios Sobre el Contenido</h3>
        <p>
          Las guías de rieles se administran y publican en latinadeveloper/railsguides.es en GitHub.
        </p>
        <p>
          Si lee esta guía y encuentra algún texto o código incorrecto que le interese, no dude en enviar una solicitud de extracción en el repositorio anterior.

          Consulte el archivo README en GitHub para saber cómo enviar una solicitud de extracción.
          Please contribute if you see any typos or factual errors.
        </p>

      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a> License</p>
<p>"Rails", "Ruby on Rails", and the Rails logo are trademarks of David Heinemeier Hansson. All rights reserved.</p>

    </div>
  </div>
</body>
</html>
