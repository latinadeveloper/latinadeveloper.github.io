<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Diseños y Renderizado en Rails — Ruby on Rails Guides</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="stylesheets/prism/default.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/prism/rails-guides.css" data-turbolinks-track="reload">
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  <script src="javascripts/prism.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/turbolinks.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/guides.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/responsive-tables.js" data-turbolinks-track="reload"></script>
  <meta property="og:title" content="Diseños y Renderizado en Rails — Ruby on Rails Guides" />
  <meta name="description" content="NO LEA ESTE ARCHIVO EN GITHUB, LAS GUÍAS SE PUBLICAN EN https://guides.rubyonrails.org.Diseños y Renderizado en RailsEsta guía cubre las características de diseño básicas de Action Controller y Action View.Después de leer esta guía, sabrá: Cómo usar los diversos métodos de renderizado integrados en Rails. Cómo crear diseños con múltiples secciones de contenido. Cómo usar parciales para SECAR tus vistas. Cómo utilizar diseños anidados (sub-plantillas)." />
  <meta property="og:description" content="NO LEA ESTE ARCHIVO EN GITHUB, LAS GUÍAS SE PUBLICAN EN https://guides.rubyonrails.org.Diseños y Renderizado en RailsEsta guía cubre las características de diseño básicas de Action Controller y Action View.Después de leer esta guía, sabrá: Cómo usar los diversos métodos de renderizado integrados en Rails. Cómo crear diseños con múltiples secciones de contenido. Cómo usar parciales para SECAR tus vistas. Cómo utilizar diseños anidados (sub-plantillas)." />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="Ruby on Rails Guides" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
  <meta property="og:type" content="website" />
</head>
<body class="guide">
  <div>
<!--    <img src="images/edge_badge.png" alt="edge-badge" id="edge-badge" />-->
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">Más en <a href="https://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        Más Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://weblog.rubyonrails.org/">Blog</a></li>
        <li class="more-info"><a href="https://guides.rubyonrails.org/">Guías</a></li>
        <li class="more-info"><a href="https://api.rubyonrails.org/">API</a></li>
        <li class="more-info"><a href="https://stackoverflow.com/questions/tagged/ruby-on-rails">Pedir Ayuda</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">Contribuir on GitHub</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Guías de Ruby on Rails">Guías de Ruby on Rails </a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Inicio</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">Index de Guías </a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="guides-section-container">
                <div class="guides-section">
                  <dt>Empieza Aqui</dt>
                  <dd><a href="getting_started.html">Introducción a Rails</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Modelos</dt>
                  <dd><a href="active_record_basics.html">Conceptos básicos de Active Record</a></dd>
                  <dd><a href="active_record_migrations.html">Migraciones de Active Record</a></dd>
                  <dd><a href="active_record_validations.html">Validaciones de Active Record</a></dd>
                  <dd><a href="active_record_callbacks.html">Devolución (callbacks) de Llamadas de Active Record</a></dd>
                  <dd><a href="association_basics.html">Asociaciones de Active Record</a></dd>
                  <dd><a href="active_record_querying.html">Interfaz de Consulta de Active Record</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Vistas</dt>
                  <dd><a href="layouts_and_rendering.html">Diseños y Renderizado en Rails</a></dd>
                  <dd><a href="form_helpers.html">Ayudantes de Formulario de Action</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Controladores</dt>
                  <dd><a href="action_controller_overview.html">Descripción General de Action Controller</a></dd>
                  <dd><a href="routing.html">Rails Routing Desde el Exterior Hacia Adentro</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Otros Componentes</dt>
                  <dd><a href="active_support_core_extensions.html">Extensiones de Núcleo de Active Support</a></dd>
                  <dd><a href="action_mailer_basics.html">Conceptos Básicos de Action Mailer</a></dd>
                  <dd><a href="active_job_basics.html">Conceptos Básicos de Active Job</a></dd>
                  <dd><a href="active_storage_overview.html">Descripción General de Active Storage</a></dd>
                  <dd><a href="action_cable_overview.html">Descripción General de Action Cable</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Temas Avanzados</dt>
                  <dd><a href="i18n.html">Rails API de Internacionalización (I18n)</a></dd>
                  <dd><a href="testing.html">Prueba de Aplicaciones de Rails</a></dd>
                  <dd><a href="security.html">Seguridad de Aplicaciones Rails</a></dd>
                  <dd><a href="debugging_rails_applications.html">Depuración de Applications Rails</a></dd>
                  <dd><a href="configuring.html">Configuración de Aplicaciones de Rails</a></dd>
                  <dd><a href="command_line.html">La Línea de Comandos de Rails</a></dd>
                  <dd><a href="asset_pipeline.html">La Canalización de Activos</a></dd>
                  <dd><a href="autoloading_and_reloading_constants.html">Constantes de Autocarga y Recarga (Zeitwerk Mode)</a></dd>
                  <dd><a href="autoloading_and_reloading_constants_classic_mode.html">Constantes de Autocarga y Recarga (modo clásico)</a></dd>
                  <dd><a href="caching_with_rails.html">Almacenamiento en Caché con Rails Descripción General</a></dd>
                  <dd><a href="api_app.html">Uso de Rails para Aplicaciones Solo API</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Extending Rails  (toda la sección necesita traducción)</dt>
                  <dd><a href="rails_on_rack.html">Rails on Rack</a></dd>
                  <dd><a href="generators.html">Creating and Customizing Rails Generators &amp; Templates</a></dd>
                </div>
            </dl>
          </div>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">Contribuir</a></li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">Guides Index</option>
              <optgroup label="Empieza Aqui">
                  <option value="getting_started.html">Introducción a Rails</option>
              </optgroup>
              <optgroup label="Modelos">
                  <option value="active_record_basics.html">Conceptos básicos de Active Record</option>
                  <option value="active_record_migrations.html">Migraciones de Active Record</option>
                  <option value="active_record_validations.html">Validaciones de Active Record</option>
                  <option value="active_record_callbacks.html">Devolución (callbacks) de Llamadas de Active Record</option>
                  <option value="association_basics.html">Asociaciones de Active Record</option>
                  <option value="active_record_querying.html">Interfaz de Consulta de Active Record</option>
              </optgroup>
              <optgroup label="Vistas">
                  <option value="layouts_and_rendering.html">Diseños y Renderizado en Rails</option>
                  <option value="form_helpers.html">Ayudantes de Formulario de Action</option>
              </optgroup>
              <optgroup label="Controladores">
                  <option value="action_controller_overview.html">Descripción General de Action Controller</option>
                  <option value="routing.html">Rails Routing Desde el Exterior Hacia Adentro</option>
              </optgroup>
              <optgroup label="Otros Componentes">
                  <option value="active_support_core_extensions.html">Extensiones de Núcleo de Active Support</option>
                  <option value="action_mailer_basics.html">Conceptos Básicos de Action Mailer</option>
                  <option value="active_job_basics.html">Conceptos Básicos de Active Job</option>
                  <option value="active_storage_overview.html">Descripción General de Active Storage</option>
                  <option value="action_cable_overview.html">Descripción General de Action Cable</option>
              </optgroup>
              <optgroup label="Temas Avanzados">
                  <option value="i18n.html">Rails API de Internacionalización (I18n)</option>
                  <option value="testing.html">Prueba de Aplicaciones de Rails</option>
                  <option value="security.html">Seguridad de Aplicaciones Rails</option>
                  <option value="debugging_rails_applications.html">Depuración de Applications Rails</option>
                  <option value="configuring.html">Configuración de Aplicaciones de Rails</option>
                  <option value="command_line.html">La Línea de Comandos de Rails</option>
                  <option value="asset_pipeline.html">La Canalización de Activos</option>
                  <option value="autoloading_and_reloading_constants.html">Constantes de Autocarga y Recarga (Zeitwerk Mode)</option>
                  <option value="autoloading_and_reloading_constants_classic_mode.html">Constantes de Autocarga y Recarga (modo clásico)</option>
                  <option value="caching_with_rails.html">Almacenamiento en Caché con Rails Descripción General</option>
                  <option value="api_app.html">Uso de Rails para Aplicaciones Solo API</option>
              </optgroup>
              <optgroup label="Extending Rails  (toda la sección necesita traducción)">
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators &amp; Templates</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <p><strong>NO LEA ESTE ARCHIVO EN GITHUB, LAS GUÍAS SE PUBLICAN EN <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p><h2>Diseños y Renderizado en Rails</h2><p>Esta guía cubre las características de diseño básicas de Action Controller y Action View.</p><p>Después de leer esta guía, sabrá:</p>
<ul>
<li>Cómo usar los diversos métodos de renderizado integrados en Rails.</li>
<li>Cómo crear diseños con múltiples secciones de contenido.</li>
<li>Cómo usar parciales para SECAR tus vistas.</li>
<li>Cómo utilizar diseños anidados (sub-plantillas).</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li><a href="#overview-how-the-pieces-fit-together">Overview: How the Pieces Fit Together</a></li>
<li>
<a href="#creating-responses">Creating Responses</a>

<ul>
<li><a href="#rendering-by-default-convention-over-configuration-in-action">Rendering by Default: Convention Over Configuration in Action</a></li>
<li><a href="#using-render">Using <code>render</code></a></li>
<li><a href="#using-redirect-to">Using <code>redirect_to</code></a></li>
<li><a href="#using-head-to-build-header-only-responses">Using <code>head</code> To Build Header-Only Responses</a></li>
</ul>
</li>
<li>
<a href="#structuring-layouts">Structuring Layouts</a>

<ul>
<li><a href="#asset-tag-helpers">Asset Tag Helpers</a></li>
<li><a href="#understanding-yield">Understanding <code>yield</code></a></li>
<li><a href="#using-the-content-for-method">Using the <code>content_for</code> Method</a></li>
<li><a href="#using-partials">Using Partials</a></li>
<li><a href="#using-nested-layouts">Using Nested Layouts</a></li>
</ul>
</li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="overview-how-the-pieces-fit-together"><a class="anchorlink" href="#overview-how-the-pieces-fit-together">1 Overview: How the Pieces Fit Together</a></h3><p>Esta guía se centra en la interacción entre el Controlador y la Vista en el triángulo Modelo-Vista-Controlador. Como sabe, el controlador es responsable de organizar todo el proceso de manejo de una solicitud en Rails, aunque normalmente entrega cualquier código pesado al modelo. Pero luego, cuando llega el momento de enviar una respuesta al usuario, el Controlador entrega las cosas a la Vista. Es ese traspaso el tema de esta guía.</p><p>A grandes rasgos, esto implica decidir qué se debe enviar como respuesta y llamar a un método apropiado para crear esa respuesta. Si la respuesta es una vista completa, Rails también hace un trabajo adicional para envolver la vista en un diseño y posiblemente extraer vistas parciales. Verá todos esos caminos más adelante en esta guía.</p><h3 id="creating-responses"><a class="anchorlink" href="#creating-responses">2 Creating Responses</a></h3><p>Desde el punto de vista del controlador, hay tres formas de crear una respuesta HTTP:</p>
<ul>
<li>Llame a <code>render</code> para crear una respuesta completa para enviar de vuelta al navegador</li>
<li>Llame a <code>redirect_to</code> para enviar un código de estado de redirección HTTP al navegador</li>
<li>Llame a <code>head</code> para crear una respuesta que consta únicamente de encabezados HTTP para enviar de vuelta al navegador</li>
</ul>
<h4 id="rendering-by-default-convention-over-configuration-in-action"><a class="anchorlink" href="#rendering-by-default-convention-over-configuration-in-action">2.1 Rendering by Default: Convention Over Configuration in Action</a></h4><p>Has escuchado que Rails promueve la "convención sobre la configuración". La representación predeterminada es un excelente ejemplo de esto. De forma predeterminada, los controladores en Rails representan automáticamente vistas con nombres que corresponden a rutas válidas. Por ejemplo, si tiene este código en su clase <code>BooksController</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">BooksController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class BooksController &lt; ApplicationController
end
">Copy</button>
</div>
<p>Y lo siguiente en su archivo de rutas:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">resources</span> <span class="ss">:books</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="resources :books
">Copy</button>
</div>
<p>Y tienes un archivo de vista<code>app/views/books/index.html.erb</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Books are coming soon!<span class="nt">&lt;/h1&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;h1&gt;Books are coming soon!&lt;/h1&gt;
">Copy</button>
</div>
<p>Rails mostrará automáticamente <code>app/views/books/index.html.erb</code> cuando navegue a<code>/books</code> y verá "¡Pronto vendrán libros!" en tu pantalla</p><p>Sin embargo, una próxima pantalla es mínimamente útil, por lo que pronto creará su modelo <code>Book</code> y agregará la acción de índice a <code>BooksController</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">BooksController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class BooksController &lt; ApplicationController
  def index
    @books = Book.all
  end
end
">Copy</button>
</div>
<p>Tenga en cuenta que no tenemos una representación explícita al final de la acción de índice de acuerdo con el principio de "convención sobre configuración". La regla es que si no renderizas algo explícitamente al final de una acción del controlador, Rails buscará automáticamente la plantilla <code>action_name.html.erb</code> en la ruta de la vista del controlador y la renderizará. Entonces, en este caso, Rails representará el archivo <code>app / views / books / index.html.erb</code>.</p><p>Si queremos mostrar las propiedades de todos los libros en nuestra vista, podemos hacerlo con una plantilla ERB como esta:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Listing Books<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;table&gt;</span>
  <span class="nt">&lt;thead&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
      <span class="nt">&lt;th&gt;</span>Title<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th&gt;</span>Content<span class="nt">&lt;/th&gt;</span>
      <span class="nt">&lt;th</span> <span class="na">colspan=</span><span class="s">"3"</span><span class="nt">&gt;&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;/thead&gt;</span>

  <span class="nt">&lt;tbody&gt;</span>
    <span class="cp">&lt;%</span> <span class="vi">@books</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">book</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">book</span><span class="p">.</span><span class="nf">title</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">book</span><span class="p">.</span><span class="nf">content</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Show"</span><span class="p">,</span> <span class="n">book</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Edit"</span><span class="p">,</span> <span class="n">edit_book_path</span><span class="p">(</span><span class="n">book</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;td&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Destroy"</span><span class="p">,</span> <span class="n">book</span><span class="p">,</span> <span class="ss">method: :delete</span><span class="p">,</span> <span class="ss">data: </span><span class="p">{</span> <span class="ss">confirm: </span><span class="s2">"Are you sure?"</span> <span class="p">}</span> <span class="cp">%&gt;</span><span class="nt">&lt;/td&gt;</span>
      <span class="nt">&lt;/tr&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;br&gt;</span>

<span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"New book"</span><span class="p">,</span> <span class="n">new_book_path</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;h1&gt;Listing Books&lt;/h1&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Title&lt;/th&gt;
      &lt;th&gt;Content&lt;/th&gt;
      &lt;th colspan="3"&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

  &lt;tbody&gt;
    &lt;% @books.each do |book| %&gt;
      &lt;tr&gt;
        &lt;td&gt;&lt;%= book.title %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= book.content %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= link_to "Show", book %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= link_to "Edit", edit_book_path(book) %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= link_to "Destroy", book, method: :delete, data: { confirm: "Are you sure?" } %&gt;&lt;/td&gt;
      &lt;/tr&gt;
    &lt;% end %&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;

&lt;%= link_to "New book", new_book_path %&gt;
'>Copy</button>
</div>
<div class="note"><p>La representación real se realiza mediante clases anidadas del módulo. <a href="https://edgeapi.rubyonrails.org/classes/ActionView/Template/Handlers.html"><code>ActionView::Template::Handlers</code></a>. Esta guía no profundiza en ese proceso, pero es importante saber que la extensión del archivo en su vista controla la elección del manejador de plantillas.</p></div><h4 id="using-render"><a class="anchorlink" href="#using-render">2.2 Using <code>render</code></a></h4><p>En la mayoría de los casos, el método <code>ActionController::Base#render</code> hace el trabajo pesado de representar el contenido de su aplicación para que lo use un navegador. Hay una variedad de formas de personalizar el comportamiento de <code>render</code>. Puede representar la vista predeterminada para una plantilla de Rails, o una plantilla específica, o un archivo, o código en línea, o nada en absoluto. Puede representar texto, JSON o XML. También puede especificar el tipo de contenido o el estado HTTP de la respuesta renderizada.</p><div class="info"><p>si desea ver los resultados exactos de una llamada a <code>render</code> sin necesidad de inspeccionarla en un navegador, puede llamar a <code>render_to_string</code>. Este método toma exactamente las mismas opciones que <code>render</code>, pero devuelve una cadena en lugar de enviar una respuesta al navegador.</p></div><h5 id="rendering-an-action-s-view"><a class="anchorlink" href="#rendering-an-action-s-view">2.2.1 Rendering an Action's View</a></h5><p>Si desea renderizar la vista que corresponde a una plantilla diferente dentro del mismo controlador, puede usar <code>render</code> con el nombre de la vista:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">update</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">book_params</span><span class="p">)</span>
    <span class="n">redirect_to</span><span class="p">(</span><span class="vi">@book</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="n">render</span> <span class="s2">"edit"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='def update
  @book = Book.find(params[:id])
  if @book.update(book_params)
    redirect_to(@book)
  else
    render "edit"
  end
end
'>Copy</button>
</div>
<p>Si falla la llamada a <code>update</code>, al llamar a la acción <code>update</code> en este controlador se mostrará la plantilla <code>edit.html.erb</code> que pertenece al mismo controlador.</p><p>Si lo prefiere, puede utilizar un símbolo en lugar de una cadena para especificar la acción a representar:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">update</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">book_params</span><span class="p">)</span>
    <span class="n">redirect_to</span><span class="p">(</span><span class="vi">@book</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="n">render</span> <span class="ss">:edit</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def update
  @book = Book.find(params[:id])
  if @book.update(book_params)
    redirect_to(@book)
  else
    render :edit
  end
end
">Copy</button>
</div>
<h5 id="rendering-an-action-s-template-from-another-controller"><a class="anchorlink" href="#rendering-an-action-s-template-from-another-controller">2.2.2 Rendering an Action's Template from Another Controller</a></h5><p>¿Qué sucede si desea renderizar una plantilla desde un controlador completamente diferente del que contiene el código de acción? También puede hacerlo con <code>render</code>, que acepta la ruta completa (relativa a<code>app/views</code>) de la plantilla para renderizar. Por ejemplo, si está ejecutando código en un "AdminProductsController" que se encuentra en <code>app / controllers / admin</code>, puede representar los resultados de una acción en una plantilla en <code>app/views/products</code> de esta manera:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="s2">"products/show"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render "products/show"
'>Copy</button>
</div>
<p>Rails sabe que esta vista pertenece a un controlador diferente debido al carácter de barra inclinado en la cadena. Si desea ser explícito, puede utilizar la opción <code>:template</code> (que era necesaria en Rails 2.2 y versiones anteriores):</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">template: </span><span class="s2">"products/show"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render template: "products/show"
'>Copy</button>
</div>
<h5 id="wrapping-it-up"><a class="anchorlink" href="#wrapping-it-up">2.2.3 Wrapping it up</a></h5><p>Las tres formas anteriores de renderizar (renderizar otra plantilla dentro del controlador, renderizar una plantilla dentro de otro controlador y renderizar un archivo arbitrario en el sistema de archivos) son en realidad variantes de la misma acción.</p><p>De hecho, en la clase BooksController, dentro de la acción de actualización donde queremos renderizar la plantilla de edición si el libro no se actualiza con éxito, todas las siguientes llamadas de renderización mostrarán la plantilla <code>edit.html.erb</code> en el` directorio de vistas / libros:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">:edit</span>
<span class="n">render</span> <span class="ss">action: :edit</span>
<span class="n">render</span> <span class="s2">"edit"</span>
<span class="n">render</span> <span class="ss">action: </span><span class="s2">"edit"</span>
<span class="n">render</span> <span class="s2">"books/edit"</span>
<span class="n">render</span> <span class="ss">template: </span><span class="s2">"books/edit"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render :edit
render action: :edit
render "edit"
render action: "edit"
render "books/edit"
render template: "books/edit"
'>Copy</button>
</div>
<p>El que use es realmente una cuestión de estilo y convención, pero la regla general es usar el más simple que tenga sentido para el código que está escribiendo.</p><h5 id="using-render-with-inline"><a class="anchorlink" href="#using-render-with-inline">2.2.4 Using <code>render</code> with <code>:inline</code></a></h5><p>El método <code>render</code> puede prescindir de una vista por completo, si está dispuesto a utilizar la opción <code>:inline</code> para proporcionar ERB como parte de la llamada al método. Esto es perfectamente válido:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">inline: </span><span class="s2">"&lt;% products.each do |p| %&gt;&lt;p&gt;&lt;%= p.name %&gt;&lt;/p&gt;&lt;% end %&gt;"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render inline: "&lt;% products.each do |p| %&gt;&lt;p&gt;&lt;%= p.name %&gt;&lt;/p&gt;&lt;% end %&gt;"
'>Copy</button>
</div>
<div class="warning"><p>rara vez hay una buena razón para usar esta opción. Mezclar ERB en sus controladores anula la orientación MVC de Rails y dificultará que otros desarrolladores sigan la lógica de su proyecto. En su lugar, utilice una vista erb separada.</p></div><p>Por defecto, el renderizado en línea usa ERB. Puede forzarlo a usar Builder en su lugar con la opción <code>:type</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">inline: </span><span class="s2">"xml.p {'Horrid coding practice!'}"</span><span class="p">,</span> <span class="ss">type: :builder</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render inline: &quot;xml.p {'Horrid coding practice!'}&quot;, type: :builder
">Copy</button>
</div>
<h5 id="rendering-text"><a class="anchorlink" href="#rendering-text">2.2.5 Rendering Text</a></h5><p>Puede enviar texto sin formato, sin ningún tipo de marcado, de vuelta al navegador utilizando
la opción <code>:plain</code> para <code>render</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">plain: </span><span class="s2">"OK"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render plain: "OK"
'>Copy</button>
</div>
<div class="info"><p>La representación de texto puro es más útil cuando responde a Ajax o
solicitudes de serviciode web que esperan algo diferente a lo apropiado</p></div><div class="note"><p>De manera predeterminada, si usa la opción <code>:plain</code>, el texto se representa sin
utilizando el diseño actual. Si quieres que Rails ponga el texto en el actual
layout, debe agregar la opción <code>layout: true</code> y usar el <code>.text.erb</code>
extensión para el archivo de diseño.</p></div><h5 id="rendering-html"><a class="anchorlink" href="#rendering-html">2.2.6 Rendering HTML</a></h5><p>Puede enviar una cadena HTML al navegador utilizando la opción <code>:html</code> para
<code>render</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">html: </span><span class="n">helpers</span><span class="p">.</span><span class="nf">tag</span><span class="p">.</span><span class="nf">strong</span><span class="p">(</span><span class="s1">'Not Found'</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render html: helpers.tag.strong('Not Found')
">Copy</button>
</div>
<div class="info"><p>esto es útil cuando representa un pequeño fragmento de código HTML.
Sin embargo, es posible que desee considerar moverlo a un archivo de plantilla si el marcado
es complejo.</p></div><div class="note"><p>Al usar la opción <code>html:</code>, las entidades HTML se escaparán si la cadena no está compuesta con API compatibles con <code>html_safe</code>.</p></div><h5 id="rendering-json"><a class="anchorlink" href="#rendering-json">2.2.7 Rendering JSON</a></h5><p>JSON es un formato de datos JavaScript utilizado por muchas bibliotecas Ajax. Rails tiene soporte incorporado para convertir objetos a JSON y renderizar ese JSON en el navegador:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">json: </span><span class="vi">@product</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render json: @product
">Copy</button>
</div>
<div class="info"><p>No es necesario llamar a <code>to_json</code> en el objeto que desea renderizar. Si usa la opción <code>:json</code>, <code>render</code> llamará automáticamente a <code>to_json</code> por usted.</p></div><h5 id="rendering-xml"><a class="anchorlink" href="#rendering-xml">2.2.8 Rendering XML</a></h5><p>Rails también tiene soporte incorporado para convertir objetos a XML y hacer que ese XML vuelva a la persona que llama:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">xml: </span><span class="vi">@product</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render xml: @product
">Copy</button>
</div>
<div class="info"><p>No necesita llamar a <code>to_xml</code> en el objeto que desea representar. Si usa la opción <code>:xml</code>, <code>render</code> llamará automáticamente a <code>to_xml</code> por usted.</p></div><h5 id="rendering-vanilla-javascript"><a class="anchorlink" href="#rendering-vanilla-javascript">2.2.9 Rendering Vanilla JavaScript</a></h5><p>Los rieles pueden representar JavaScript vainilla:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">js: </span><span class="s2">"alert('Hello Rails');"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render js: &quot;alert('Hello Rails');&quot;
">Copy</button>
</div>
<p>Esto enviará la cadena suministrada al navegador con un tipo MIME de <code>text/javascript</code>.</p><h5 id="rendering-raw-body"><a class="anchorlink" href="#rendering-raw-body">2.2.10 Rendering raw body</a></h5><p>Puede enviar un contenido sin procesar al navegador, sin configurar ningún contenido.
type, usando la opción <code>:body</code> para<code>render</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">body: </span><span class="s2">"raw"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render body: "raw"
'>Copy</button>
</div>
<div class="info"><p>esta opción debe usarse solo si no le importa el tipo de contenido de
la respuesta. El uso de <code>:plain</code> o <code>:html</code> podría ser más apropiado para la mayoría de
hora.</p></div><div class="note"><p>A menos que se anule, su respuesta devuelta de esta opción de procesamiento será
<code>text/plain</code>, ya que ese es el tipo de contenido predeterminado de la respuesta Action Dispatch.</p></div><h5 id="rendering-raw-file"><a class="anchorlink" href="#rendering-raw-file">2.2.11 Rendering raw file</a></h5><p>Los rieles pueden representar un archivo sin formato desde una ruta absoluta. Esto es útil para
renderización condicional de archivos estáticos como páginas de error.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">file: </span><span class="s2">"</span><span class="si">#{</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="si">}</span><span class="s2">/public/404.html"</span><span class="p">,</span> <span class="ss">layout: </span><span class="kp">false</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render file: "#{Rails.root}/public/404.html", layout: false
'>Copy</button>
</div>
<p>Esto representa el archivo sin formato (no es compatible con ERB u otros controladores). Por
por defecto se representa dentro del diseño actual.</p><div class="warning"><p>El uso de la opción <code>:file</code> en combinación con la entrada de los usuarios puede provocar problemas de seguridad
ya que un atacante podría usar esta acción para acceder a archivos confidenciales de seguridad en su sistema de archivos.</p></div><div class="info"><p><code>send_file</code> suele ser una opción mejor y más rápida si no se requiere un diseño.</p></div><h5 id="rendering-objects"><a class="anchorlink" href="#rendering-objects">2.2.12 Rendering objects</a></h5><p>Los rieles pueden representar objetos que respondan a <code>:render_in</code>.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="no">MyComponent</span><span class="p">.</span><span class="nf">new</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render MyComponent.new
">Copy</button>
</div>
<p>Esto llama a <code>render_in</code> en el objeto proporcionado con el contexto de vista actual.</p><h5 id="options-for-render"><a class="anchorlink" href="#options-for-render">2.2.13 Options for <code>render</code></a></h5><p>Las llamadas al método <code>render</code> generalmente aceptan seis opciones:</p>
<ul>
<li><code>:content_type</code></li>
<li><code>:layout</code></li>
<li><code>:location</code></li>
<li><code>:status</code></li>
<li><code>:formats</code></li>
<li><code>:variants</code></li>
</ul>
<h6 id="the-content-type-option"><a class="anchorlink" href="#the-content-type-option">2.2.13.1 The <code>:content_type</code> Option</a></h6><p>Por defecto, Rails servirá los resultados de una operación de renderizado con el tipo de contenido MIME de <code>text / html</code> (o<code>application / json</code> si usa la opción <code>: json</code>, o<code>application / xml</code> para el <code>: opción xml</code>). Hay momentos en los que le gustaría cambiar esto, y puede hacerlo configurando la opción <code>:content_type</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">template: </span><span class="s2">"feed"</span><span class="p">,</span> <span class="ss">content_type: </span><span class="s2">"application/rss"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render template: "feed", content_type: "application/rss"
'>Copy</button>
</div>
<h6 id="the-layout-option"><a class="anchorlink" href="#the-layout-option">2.2.13.2 The <code>:layout</code> Option</a></h6><p>Con la mayoría de las opciones para "renderizar", el contenido renderizado se muestra como parte del diseño actual. Aprenderá más sobre los diseños y cómo usarlos más adelante en esta guía.</p><p>Puedes usar la opción <code>:layout</code> para decirle a Rails que use un archivo específico como diseño para la acción actual:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">layout: </span><span class="s2">"special_layout"</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='render layout: "special_layout"
'>Copy</button>
</div>
<p>También puedes decirle a Rails que renderice sin ningún diseño:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">layout: </span><span class="kp">false</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render layout: false
">Copy</button>
</div>
<h6 id="the-location-option"><a class="anchorlink" href="#the-location-option">2.2.13.3 The <code>:location</code> Option</a></h6><p>Puede usar la opción <code>:location</code> para establecer el encabezado HTTP <code>Location</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">xml: </span><span class="n">photo</span><span class="p">,</span> <span class="ss">location: </span><span class="n">photo_url</span><span class="p">(</span><span class="n">photo</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render xml: photo, location: photo_url(photo)
">Copy</button>
</div>
<h6 id="the-status-option"><a class="anchorlink" href="#the-status-option">2.2.13.4 The <code>:status</code> Option</a></h6><p>Rails generará automáticamente una respuesta con el código de estado HTTP correcto (en la mayoría de los casos, esto es <code>200 OK</code>). Puede usar la opción <code>:status</code> para cambiar esto:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">status: </span><span class="mi">500</span>
<span class="n">render</span> <span class="ss">status: :forbidden</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render status: 500
render status: :forbidden
">Copy</button>
</div>
<p>Rails comprende tanto los códigos de estado numéricos como los símbolos correspondientes que se muestran a continuación.</p>
<table>
<thead>
<tr>
<th>Response Class</th>
<th>HTTP Status Code</th>
<th>Symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Informational</strong></td>
<td>100</td>
<td>:continue</td>
</tr>
<tr>
<td></td>
<td>101</td>
<td>:switching_protocols</td>
</tr>
<tr>
<td></td>
<td>102</td>
<td>:processing</td>
</tr>
<tr>
<td><strong>Success</strong></td>
<td>200</td>
<td>:ok</td>
</tr>
<tr>
<td></td>
<td>201</td>
<td>:created</td>
</tr>
<tr>
<td></td>
<td>202</td>
<td>:accepted</td>
</tr>
<tr>
<td></td>
<td>203</td>
<td>:non_authoritative_information</td>
</tr>
<tr>
<td></td>
<td>204</td>
<td>:no_content</td>
</tr>
<tr>
<td></td>
<td>205</td>
<td>:reset_content</td>
</tr>
<tr>
<td></td>
<td>206</td>
<td>:partial_content</td>
</tr>
<tr>
<td></td>
<td>207</td>
<td>:multi_status</td>
</tr>
<tr>
<td></td>
<td>208</td>
<td>:already_reported</td>
</tr>
<tr>
<td></td>
<td>226</td>
<td>:im_used</td>
</tr>
<tr>
<td><strong>Redirection</strong></td>
<td>300</td>
<td>:multiple_choices</td>
</tr>
<tr>
<td></td>
<td>301</td>
<td>:moved_permanently</td>
</tr>
<tr>
<td></td>
<td>302</td>
<td>:found</td>
</tr>
<tr>
<td></td>
<td>303</td>
<td>:see_other</td>
</tr>
<tr>
<td></td>
<td>304</td>
<td>:not_modified</td>
</tr>
<tr>
<td></td>
<td>305</td>
<td>:use_proxy</td>
</tr>
<tr>
<td></td>
<td>307</td>
<td>:temporary_redirect</td>
</tr>
<tr>
<td></td>
<td>308</td>
<td>:permanent_redirect</td>
</tr>
<tr>
<td><strong>Client Error</strong></td>
<td>400</td>
<td>:bad_request</td>
</tr>
<tr>
<td></td>
<td>401</td>
<td>:unauthorized</td>
</tr>
<tr>
<td></td>
<td>402</td>
<td>:payment_required</td>
</tr>
<tr>
<td></td>
<td>403</td>
<td>:forbidden</td>
</tr>
<tr>
<td></td>
<td>404</td>
<td>:not_found</td>
</tr>
<tr>
<td></td>
<td>405</td>
<td>:method_not_allowed</td>
</tr>
<tr>
<td></td>
<td>406</td>
<td>:not_acceptable</td>
</tr>
<tr>
<td></td>
<td>407</td>
<td>:proxy_authentication_required</td>
</tr>
<tr>
<td></td>
<td>408</td>
<td>:request_timeout</td>
</tr>
<tr>
<td></td>
<td>409</td>
<td>:conflict</td>
</tr>
<tr>
<td></td>
<td>410</td>
<td>:gone</td>
</tr>
<tr>
<td></td>
<td>411</td>
<td>:length_required</td>
</tr>
<tr>
<td></td>
<td>412</td>
<td>:precondition_failed</td>
</tr>
<tr>
<td></td>
<td>413</td>
<td>:payload_too_large</td>
</tr>
<tr>
<td></td>
<td>414</td>
<td>:uri_too_long</td>
</tr>
<tr>
<td></td>
<td>415</td>
<td>:unsupported_media_type</td>
</tr>
<tr>
<td></td>
<td>416</td>
<td>:range_not_satisfiable</td>
</tr>
<tr>
<td></td>
<td>417</td>
<td>:expectation_failed</td>
</tr>
<tr>
<td></td>
<td>421</td>
<td>:misdirected_request</td>
</tr>
<tr>
<td></td>
<td>422</td>
<td>:unprocessable_entity</td>
</tr>
<tr>
<td></td>
<td>423</td>
<td>:locked</td>
</tr>
<tr>
<td></td>
<td>424</td>
<td>:failed_dependency</td>
</tr>
<tr>
<td></td>
<td>426</td>
<td>:upgrade_required</td>
</tr>
<tr>
<td></td>
<td>428</td>
<td>:precondition_required</td>
</tr>
<tr>
<td></td>
<td>429</td>
<td>:too_many_requests</td>
</tr>
<tr>
<td></td>
<td>431</td>
<td>:request_header_fields_too_large</td>
</tr>
<tr>
<td></td>
<td>451</td>
<td>:unavailable_for_legal_reasons</td>
</tr>
<tr>
<td><strong>Server Error</strong></td>
<td>500</td>
<td>:internal_server_error</td>
</tr>
<tr>
<td></td>
<td>501</td>
<td>:not_implemented</td>
</tr>
<tr>
<td></td>
<td>502</td>
<td>:bad_gateway</td>
</tr>
<tr>
<td></td>
<td>503</td>
<td>:service_unavailable</td>
</tr>
<tr>
<td></td>
<td>504</td>
<td>:gateway_timeout</td>
</tr>
<tr>
<td></td>
<td>505</td>
<td>:http_version_not_supported</td>
</tr>
<tr>
<td></td>
<td>506</td>
<td>:variant_also_negotiates</td>
</tr>
<tr>
<td></td>
<td>507</td>
<td>:insufficient_storage</td>
</tr>
<tr>
<td></td>
<td>508</td>
<td>:loop_detected</td>
</tr>
<tr>
<td></td>
<td>510</td>
<td>:not_extended</td>
</tr>
<tr>
<td></td>
<td>511</td>
<td>:network_authentication_required</td>
</tr>
</tbody>
</table>
<div class="note"><p>Si intenta renderizar contenido junto con un código de estado sin contenido
(100-199, 204, 205 o 304), se eliminará de la respuesta.</p></div><h6 id="the-formats-option"><a class="anchorlink" href="#the-formats-option">2.2.13.5 The <code>:formats</code> Option</a></h6><p>Rails usa el formato especificado en la solicitud (o <code>:html</code> por defecto). Usted puede
cambie esto pasando la opción <code>:formats</code> con un símbolo o una matriz:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">render</span> <span class="ss">formats: :xml</span>
<span class="n">render</span> <span class="ss">formats: </span><span class="p">[</span><span class="ss">:json</span><span class="p">,</span> <span class="ss">:xml</span><span class="p">]</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="render formats: :xml
render formats: [:json, :xml]
">Copy</button>
</div>
<p>Si no existe una plantilla con el formato especificado, se genera un error <code>ActionView::MissingTemplate</code>.</p><h6 id="the-variants-option"><a class="anchorlink" href="#the-variants-option">2.2.13.6 The <code>:variants</code> Option</a></h6><p>Esto le dice a Rails que busque variaciones de la plantilla del mismo formato.
Puede especificar una lista de variantes pasando la opción <code>:variants</code> con un símbolo o una matriz.</p><p>Un ejemplo de uso sería este.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># called in HomeController#index</span>
<span class="n">render</span> <span class="ss">variants: </span><span class="p">[</span><span class="ss">:mobile</span><span class="p">,</span> <span class="ss">:desktop</span><span class="p">]</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="# called in HomeController#index
render variants: [:mobile, :desktop]
">Copy</button>
</div>
<p>Con este conjunto de variantes, Rails buscará el siguiente conjunto de plantillas y utilizará la primera que exista.</p>
<ul>
<li><code>app/views/home/index.html+mobile.erb</code></li>
<li><code>app/views/home/index.html+desktop.erb</code></li>
<li><code>app/views/home/index.html.erb</code></li>
</ul>
<p>Si no existe una plantilla con el formato especificado, se genera un error <code>ActionView::MissingTemplate</code>.</p><p>En lugar de configurar la variante en la llamada de renderizado, también puede configurarla en el objeto de solicitud en la acción de su controlador.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="n">request</span><span class="p">.</span><span class="nf">variant</span> <span class="o">=</span> <span class="n">determine_variant</span>
<span class="k">end</span>

<span class="kp">private</span>

<span class="k">def</span> <span class="nf">determine_variant</span>
  <span class="n">variant</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="c1"># some code to determine the variant(s) to use</span>
  <span class="n">variant</span> <span class="o">=</span> <span class="ss">:mobile</span> <span class="k">if</span> <span class="n">session</span><span class="p">[</span><span class="ss">:use_mobile</span><span class="p">]</span>

  <span class="n">variant</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def index
  request.variant = determine_variant
end

private

def determine_variant
  variant = nil
  # some code to determine the variant(s) to use
  variant = :mobile if session[:use_mobile]

  variant
end
">Copy</button>
</div>
<h5 id="finding-layouts"><a class="anchorlink" href="#finding-layouts">2.2.14 Finding Layouts</a></h5><p>Para encontrar el diseño actual, Rails primero busca un archivo en <code>app/views/layouts</code> con el mismo nombre base que el controlador. Por ejemplo, las acciones de renderizado de la clase <code>PhotosController</code> usarán <code>app/views/layouts/photos.html.erb</code> (o <code>app/views/layouts/photos.builder</code>). Si no existe un diseño específico del controlador, Rails usará <code>app/views/layouts/application.html.erb</code> o <code>app/views/layouts/application.builder</code>. Si no hay un diseño <code>.erb</code>, Rails usará un diseño <code>.builder</code> si existe. Rails también proporciona varias formas de asignar diseños específicos de manera más precisa a controladores y acciones individuales.</p><h6 id="specifying-layouts-for-controllers"><a class="anchorlink" href="#specifying-layouts-for-controllers">2.2.14.1 Specifying Layouts for Controllers</a></h6><p>Puede anular las convenciones de diseño predeterminadas en sus controladores utilizando la declaración <code>layout</code>. Por ejemplo:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="s2">"inventory"</span>
  <span class="c1">#...</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class ProductsController &lt; ApplicationController
  layout "inventory"
  #...
end
'>Copy</button>
</div>
<p>Con esta declaración, todas las vistas generadas por <code>ProductsController</code> usarán <code>app/views/layouts/Inventory.html.erb</code> como su diseño.</p><p>Para asignar un diseño específico para toda la aplicación, use una declaración de diseño en su clase ApplicationController:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">layout</span> <span class="s2">"main"</span>
  <span class="c1">#...</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class ApplicationController &lt; ActionController::Base
  layout "main"
  #...
end
'>Copy</button>
</div>
<p>Con esta declaración, todas las vistas en toda la aplicación usarán <code>app/views/layouts/main.html.erb</code> para su diseño.</p><h6 id="choosing-layouts-at-runtime"><a class="anchorlink" href="#choosing-layouts-at-runtime">2.2.14.2 Choosing Layouts at Runtime</a></h6><p>Puede utilizar un símbolo para aplazar la elección del diseño hasta que se procese una solicitud:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="ss">:products_layout</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@product</span> <span class="o">=</span> <span class="no">Product</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">end</span>

  <span class="kp">private</span>
    <span class="k">def</span> <span class="nf">products_layout</span>
      <span class="vi">@current_user</span><span class="p">.</span><span class="nf">special?</span> <span class="p">?</span> <span class="s2">"special"</span> <span class="p">:</span> <span class="s2">"products"</span>
    <span class="k">end</span>

<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class ProductsController &lt; ApplicationController
  layout :products_layout

  def show
    @product = Product.find(params[:id])
  end

  private
    def products_layout
      @current_user.special? ? "special" : "products"
    end

end
'>Copy</button>
</div>
<p>Ahora, si el usuario actual es un usuario especial, obtendrá un diseño especial al ver un producto.</p><p>Incluso puede utilizar un método en línea, como Proc, para determinar el diseño. Por ejemplo, si pasa un objeto Proc, el bloque que le da a Proc recibirá la instancia del <code>controller</code>, por lo que el diseño se puede determinar en función de la solicitud actual:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="no">Proc</span><span class="p">.</span><span class="nf">new</span> <span class="p">{</span> <span class="o">|</span><span class="n">controller</span><span class="o">|</span> <span class="n">controller</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">xhr?</span> <span class="p">?</span> <span class="s2">"popup"</span> <span class="p">:</span> <span class="s2">"application"</span> <span class="p">}</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class ProductsController &lt; ApplicationController
  layout Proc.new { |controller| controller.request.xhr? ? "popup" : "application" }
end
'>Copy</button>
</div>
<h6 id="conditional-layouts"><a class="anchorlink" href="#conditional-layouts">2.2.14.3 Conditional Layouts</a></h6><p>Los diseños especificados en el nivel del controlador admiten las opciones <code>:only</code> y <code>:except</code>. Estas opciones toman un nombre de método o una matriz de nombres de métodos, correspondientes a los nombres de métodos dentro del controlador:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">layout</span> <span class="s2">"product"</span><span class="p">,</span> <span class="ss">except: </span><span class="p">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:rss</span><span class="p">]</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class ProductsController &lt; ApplicationController
  layout "product", except: [:index, :rss]
end
'>Copy</button>
</div>
<p>Con esta declaración, el diseño <code>product</code> se usaría para todo menos los métodos <code>rss</code> e <code>index</code>.</p><h6 id="layout-inheritance"><a class="anchorlink" href="#layout-inheritance">2.2.14.4 Layout Inheritance</a></h6><p>Las declaraciones de diseño caen en cascada hacia abajo en la jerarquía, y las declaraciones de diseño más específicas siempre anulan las más generales. Por ejemplo:</p>
<ul>
<li>
<p><code>application_controller.rb</code></p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">layout</span> <span class="s2">"main"</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class ApplicationController &lt; ActionController::Base
  layout "main"
end
'>Copy</button>
</div>
</li>
<li>
<p><code>articles_controller.rb</code></p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ArticlesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="class ArticlesController &lt; ApplicationController
end
">Copy</button>
</div>
</li>
<li>
<p><code>special_articles_controller.rb</code></p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">SpecialArticlesController</span> <span class="o">&lt;</span> <span class="no">ArticlesController</span>
  <span class="n">layout</span> <span class="s2">"special"</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class SpecialArticlesController &lt; ArticlesController
  layout "special"
end
'>Copy</button>
</div>
</li>
<li>
<p><code>old_articles_controller.rb</code></p>
<div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">OldArticlesController</span> <span class="o">&lt;</span> <span class="no">SpecialArticlesController</span>
  <span class="n">layout</span> <span class="kp">false</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@article</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@old_articles</span> <span class="o">=</span> <span class="no">Article</span><span class="p">.</span><span class="nf">older</span>
    <span class="n">render</span> <span class="ss">layout: </span><span class="s2">"old"</span>
  <span class="k">end</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='class OldArticlesController &lt; SpecialArticlesController
  layout false

  def show
    @article = Article.find(params[:id])
  end

  def index
    @old_articles = Article.older
    render layout: "old"
  end
  # ...
end
'>Copy</button>
</div>
</li>
</ul>
<p>En esta aplication:</p>
<ul>
<li>En general, las vistas se renderizarán en el diseño <code>main</code>
</li>
<li>
<code>ArticlesController#index</code> usará el diseño <code>main</code>
</li>
<li>
<code>SpecialArticlesController#index</code> usará el diseño <code>special</code>
</li>
<li>
<code>OldArticlesController#show</code> no usará ningún diseño</li>
<li>
<code>OldArticlesController#index</code> usará el diseño <code>old</code>
</li>
</ul>
<h6 id="template-inheritance"><a class="anchorlink" href="#template-inheritance">2.2.14.5 Template Inheritance</a></h6><p>Similar a la lógica de Herencia de Diseño, si una plantilla o parcial no se encuentra en la ruta convencional, el controlador buscará una plantilla o parcial para representar en su cadena de herencia. Por ejemplo:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="c1"># in app/controllers/application_controller</span>
<span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">Base</span>
<span class="k">end</span>

<span class="c1"># in app/controllers/admin_controller</span>
<span class="k">class</span> <span class="nc">AdminController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
<span class="k">end</span>

<span class="c1"># in app/controllers/admin/products_controller</span>
<span class="k">class</span> <span class="nc">Admin::ProductsController</span> <span class="o">&lt;</span> <span class="no">AdminController</span>
  <span class="k">def</span> <span class="nf">index</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="# in app/controllers/application_controller
class ApplicationController &lt; ActionController::Base
end

# in app/controllers/admin_controller
class AdminController &lt; ApplicationController
end

# in app/controllers/admin/products_controller
class Admin::ProductsController &lt; AdminController
  def index
  end
end
">Copy</button>
</div>
<p>El orden de búsqueda para una acción <code>admin/products#index</code> será:</p>
<ul>
<li><code>app/views/admin/products/</code></li>
<li><code>app/views/admin/</code></li>
<li><code>app/views/application/</code></li>
</ul>
<p>Esto hace que <code>app/views/application/</code> sea un gran lugar para sus parciales compartidos, que luego se pueden representar en su ERB como tal:</p><div class="code_container">
<pre><code class="highlight erb"><span class="c">&lt;%# app/views/admin/products/index.html.erb %&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@products</span> <span class="o">||</span> <span class="s2">"empty_list"</span> <span class="cp">%&gt;</span>

<span class="c">&lt;%# app/views/application/_empty_list.html.erb %&gt;</span>
There are no items in this list <span class="nt">&lt;em&gt;</span>yet<span class="nt">&lt;/em&gt;</span>.
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%# app/views/admin/products/index.html.erb %&gt;
&lt;%= render @products || "empty_list" %&gt;

&lt;%# app/views/application/_empty_list.html.erb %&gt;
There are no items in this list &lt;em&gt;yet&lt;/em&gt;.
'>Copy</button>
</div>
<h5 id="avoiding-double-render-errors"><a class="anchorlink" href="#avoiding-double-render-errors">2.2.15 Avoiding Double Render Errors</a></h5><p>Tarde o temprano, la mayoría de los desarrolladores de Rails verán el mensaje de error "Solo se puede renderizar o redirigir una vez por acción". Si bien esto es molesto, es relativamente fácil de solucionar. Por lo general, ocurre debido a un malentendido fundamental de la forma en que funciona "render".</p><p>Por ejemplo, aquí hay un código que activará este error:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">special?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"special_show"</span>
  <span class="k">end</span>
  <span class="n">render</span> <span class="ss">action: </span><span class="s2">"regular_show"</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='def show
  @book = Book.find(params[:id])
  if @book.special?
    render action: "special_show"
  end
  render action: "regular_show"
end
'>Copy</button>
</div>
<p>Si <code>@book.special?</code> Se evalúa como <code>true</code>, Rails iniciará el proceso de renderizado para volcar la variable <code>@book</code> en la vista <code>special_show</code>. Pero esto <em>no</em> detendrá la ejecución del resto del código en la acción <code>show</code>, y cuando Rails llegue al final de la acción, comenzará a representar la vista <code>regular_show</code> y arrojará un error. La solución es simple: asegúrese de tener solo una llamada a <code>render</code> o <code>redirect</code> en una única ruta de código. Una cosa que puede ayudar es "y volver". Aquí hay una versión parcheada del método:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">special?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"special_show"</span> <span class="n">and</span> <span class="k">return</span>
  <span class="k">end</span>
  <span class="n">render</span> <span class="ss">action: </span><span class="s2">"regular_show"</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='def show
  @book = Book.find(params[:id])
  if @book.special?
    render action: "special_show" and return
  end
  render action: "regular_show"
end
'>Copy</button>
</div>
<p>Asegúrese de usar <code>and return</code> en lugar de<code>&amp;&amp; return</code> porque <code>&amp;&amp; return</code> no funcionará debido a la precedencia del operador en el lenguaje Ruby.</p><p>Tenga en cuenta que el renderizado implícito realizado por ActionController detecta si se ha llamado a <code>render</code>, por lo que lo siguiente funcionará sin errores:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">special?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"special_show"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='def show
  @book = Book.find(params[:id])
  if @book.special?
    render action: "special_show"
  end
end
'>Copy</button>
</div>
<p>Esto renderizará un libro con <code>special?</code> Establecido con la plantilla <code>special_show</code>, mientras que otros libros se renderizarán con la plantilla <code>show</code> predeterminada.</p><h4 id="using-redirect-to"><a class="anchorlink" href="#using-redirect-to">2.3 Using <code>redirect_to</code></a></h4><p>Otra forma de manejar la devolución de respuestas a una solicitud HTTP es con <code>redirect_to</code>. Como ha visto, <code>render</code> le dice a Rails qué vista (u otro activo) usar para construir una respuesta. El método <code>redirect_to</code> hace algo completamente diferente: le dice al navegador que envíe una nueva solicitud para una URL diferente. Por ejemplo, puede redirigir desde donde se encuentre en su código al índice de fotos en su aplicación con esta llamada:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">redirect_to</span> <span class="n">photos_url</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="redirect_to photos_url
">Copy</button>
</div>
<p>Puede utilizar <code>redirect_back</code> para devolver al usuario a la página de la que acaba de llegar.
Esta ubicación se extrae del encabezado <code>HTTP_REFERER</code> que no está garantizado
para ser configurado por el navegador, por lo que debe proporcionar el <code>fallback_location</code>
utilizar en este caso.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">redirect_back</span><span class="p">(</span><span class="ss">fallback_location: </span><span class="n">root_path</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="redirect_back(fallback_location: root_path)
">Copy</button>
</div>
<div class="note"><p><code>redirect_to</code> y <code>redirect_back</code> no se detienen y regresan inmediatamente de la ejecución del método, simplemente establecen respuestas HTTP. Se ejecutarán las declaraciones que se produzcan después de ellas en un método. Puede detener mediante un "retorno" explícito o algún otro mecanismo de detención, si es necesario.</p></div><h5 id="getting-a-different-redirect-status-code"><a class="anchorlink" href="#getting-a-different-redirect-status-code">2.3.1 Getting a Different Redirect Status Code</a></h5><p>Rails usa el código de estado HTTP 302, una redirección temporal, cuando llamas a <code>redirect_to</code>. Si desea usar un código de estado diferente, quizás 301, una redirección permanente, puede usar la opción <code>:status</code>:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">redirect_to</span> <span class="n">photos_path</span><span class="p">,</span> <span class="ss">status: </span><span class="mi">301</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="redirect_to photos_path, status: 301
">Copy</button>
</div>
<p>Al igual que la opción <code>:status</code> para<code>ender</code>, <code>:status</code> para <code>redirect_to</code> acepta designaciones de encabezado tanto numéricas como simbólicas.</p><h5 id="the-difference-between-render-and-redirect-to"><a class="anchorlink" href="#the-difference-between-render-and-redirect-to">2.3.2 The Difference Between <code>render</code> and <code>redirect_to</code></a></h5><p>A veces, los desarrolladores sin experiencia piensan en <code>redirect_to</code> como una especie de comando <code>goto</code>, que mueve la ejecución de un lugar a otro en su código Rails. Esto no es correcto. Su código deja de ejecutarse y espera una nueva solicitud del navegador. Simplemente sucede que le ha dicho al navegador qué solicitud debe realizar a continuación, enviando un código de estado HTTP 302.</p><p>Considere estas acciones para ver la diferencia:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">nil?</span>
    <span class="n">render</span> <span class="ss">action: </span><span class="s2">"index"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='def index
  @books = Book.all
end

def show
  @book = Book.find_by(id: params[:id])
  if @book.nil?
    render action: "index"
  end
end
'>Copy</button>
</div>
<p>Con el código en esta forma, probablemente habrá un problema si la variable <code>@book</code> es <code>nil</code>. Recuerde, una <code>render :action</code> no ejecuta ningún código en la acción de destino, por lo que nada configurará la variable <code>@books</code> que probablemente requiera la vista <code>index</code>. Una forma de solucionar esto es redirigir en lugar de renderizar:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">nil?</span>
    <span class="n">redirect_to</span> <span class="ss">action: :index</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="def index
  @books = Book.all
end

def show
  @book = Book.find_by(id: params[:id])
  if @book.nil?
    redirect_to action: :index
  end
end
">Copy</button>
</div>
<p>Con este código, el navegador hará una nueva solicitud para la página de índice, se ejecutará el código del método <code>index</code> y todo estará bien.</p><p>El único inconveniente de este código es que requiere un viaje de ida y vuelta al navegador: el navegador solicitó la acción de mostrar con <code>/books/1</code> y el controlador encuentra que no hay libros, por lo que el controlador envía una respuesta de redirección 302 a el navegador le dice que vaya a <code>/books/</code>, el navegador cumple y envía una nueva solicitud al controlador solicitando ahora la acción <code>index</code>, el controlador luego obtiene todos los libros en la base de datos y muestra la plantilla de índice, enviándolo de nuevo al navegador que luego lo muestra en su pantalla.</p><p>Si bien en una aplicación pequeña, esta latencia adicional puede no ser un problema, es algo en lo que pensar si el tiempo de respuesta es una preocupación. Podemos demostrar una forma de manejar esto con un ejemplo artificial:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">def</span> <span class="nf">index</span>
  <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">show</span>
  <span class="vi">@book</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">id: </span><span class="n">params</span><span class="p">[</span><span class="ss">:id</span><span class="p">])</span>
  <span class="k">if</span> <span class="vi">@book</span><span class="p">.</span><span class="nf">nil?</span>
    <span class="vi">@books</span> <span class="o">=</span> <span class="no">Book</span><span class="p">.</span><span class="nf">all</span>
    <span class="n">flash</span><span class="p">.</span><span class="nf">now</span><span class="p">[</span><span class="ss">:alert</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Your book was not found"</span>
    <span class="n">render</span> <span class="s2">"index"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='def index
  @books = Book.all
end

def show
  @book = Book.find_by(id: params[:id])
  if @book.nil?
    @books = Book.all
    flash.now[:alert] = "Your book was not found"
    render "index"
  end
end
'>Copy</button>
</div>
<p>Esto detectaría que no hay libros con el ID especificado, completará la variable de instancia <code>@ books</code> con todos los libros en el modelo y luego representará directamente la plantilla<code>index.html.erb</code>, devolviéndola al navegador con una mensaje de alerta flash para decirle al usuario lo sucedido.</p><h4 id="using-head-to-build-header-only-responses"><a class="anchorlink" href="#using-head-to-build-header-only-responses">2.4 Using <code>head</code> To Build Header-Only Responses</a></h4><p>El método <code>head</code> se puede usar para enviar respuestas con solo encabezados al navegador. El método <code>head</code> acepta un número o símbolo (ver <a href="#the-status-option">reference table</a>) que representa un código de estado HTTP. El argumento de opciones se interpreta como un hash de nombres y valores de encabezado. Por ejemplo, puede devolver solo un encabezado de error:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">head</span> <span class="ss">:bad_request</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="head :bad_request
">Copy</button>
</div>
<p>Esto produciría el siguiente encabezado:</p><div class="code_container">
<pre><code class="highlight plaintext">HTTP/1.1 400 Bad Request
Connection: close
Date: Sun, 24 Jan 2010 12:15:53 GMT
Transfer-Encoding: chunked
Content-Type: text/html; charset=utf-8
X-Runtime: 0.013483
Set-Cookie: _blog_session=...snip...; path=/; HttpOnly
Cache-Control: no-cache
</code></pre>
<button class="clipboard-button" data-clipboard-text="HTTP/1.1 400 Bad Request
Connection: close
Date: Sun, 24 Jan 2010 12:15:53 GMT
Transfer-Encoding: chunked
Content-Type: text/html; charset=utf-8
X-Runtime: 0.013483
Set-Cookie: _blog_session=...snip...; path=/; HttpOnly
Cache-Control: no-cache
">Copy</button>
</div>
<p>O puede usar otros encabezados HTTP para transmitir otra información:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="n">head</span> <span class="ss">:created</span><span class="p">,</span> <span class="ss">location: </span><span class="n">photo_path</span><span class="p">(</span><span class="vi">@photo</span><span class="p">)</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="head :created, location: photo_path(@photo)
">Copy</button>
</div>
<p>Que produciría:</p><div class="code_container">
<pre><code class="highlight plaintext">HTTP/1.1 201 Created
Connection: close
Date: Sun, 24 Jan 2010 12:16:44 GMT
Transfer-Encoding: chunked
Location: /photos/1
Content-Type: text/html; charset=utf-8
X-Runtime: 0.083496
Set-Cookie: _blog_session=...snip...; path=/; HttpOnly
Cache-Control: no-cache
</code></pre>
<button class="clipboard-button" data-clipboard-text="HTTP/1.1 201 Created
Connection: close
Date: Sun, 24 Jan 2010 12:16:44 GMT
Transfer-Encoding: chunked
Location: /photos/1
Content-Type: text/html; charset=utf-8
X-Runtime: 0.083496
Set-Cookie: _blog_session=...snip...; path=/; HttpOnly
Cache-Control: no-cache
">Copy</button>
</div>
<h3 id="structuring-layouts"><a class="anchorlink" href="#structuring-layouts">3 Structuring Layouts</a></h3><p>Cuando Rails representa una vista como respuesta, lo hace combinando la vista con el diseño actual, utilizando las reglas para encontrar el diseño actual que se trataron anteriormente en esta guía. Dentro de un diseño, tiene acceso a tres herramientas para combinar diferentes bits de salida para formar la respuesta general:</p>
<ul>
<li>Asset tags</li>
<li>
<code>yield</code> and <code>content_for</code>
</li>
<li>Partials</li>
</ul>
<h4 id="asset-tag-helpers"><a class="anchorlink" href="#asset-tag-helpers">3.1 Asset Tag Helpers</a></h4><p>Los ayudantes de etiquetas de activos proporcionan métodos para generar HTML que vinculan vistas a feeds, JavaScript, hojas de estilo, imágenes, videos y audios. Hay seis ayudantes de etiquetas de activos disponibles en Rails:</p>
<ul>
<li><code>auto_discovery_link_tag</code></li>
<li><code>javascript_include_tag</code></li>
<li><code>stylesheet_link_tag</code></li>
<li><code>image_tag</code></li>
<li><code>video_tag</code></li>
<li><code>audio_tag</code></li>
</ul>
<p>Puede usar estas etiquetas en diseños u otras vistas, aunque <code>auto_discovery_link_tag</code>,<code>javascript_include_tag</code> y <code>stylesheet_link_tag</code>, se usan más comúnmente en la sección <code>&lt;head&gt;</code> de un diseño.</p><div class="warning"><p>Los asistentes de etiquetas de activos <em>no</em> verifican la existencia de los activos en las ubicaciones especificadas; simplemente asumen que sabes lo que estás haciendo y generan el enlace.</p></div><h5 id="linking-to-feeds-with-the-auto-discovery-link-tag"><a class="anchorlink" href="#linking-to-feeds-with-the-auto-discovery-link-tag">3.1.1 Linking to Feeds with the <code>auto_discovery_link_tag</code></a></h5><p>El ayudante <code>auto_discovery_link_tag</code> crea HTML que la mayoría de los navegadores y lectores de feeds pueden utilizar para detectar la presencia de feeds RSS, Atom o JSON. Toma el tipo de enlace (<code>:rss</code>, <code>:atom</code> o <code>: json</code>), un hash de opciones que se pasan a url_for y un hash de opciones para la etiqueta:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">auto_discovery_link_tag</span><span class="p">(</span><span class="ss">:rss</span><span class="p">,</span> <span class="p">{</span><span class="ss">action: </span><span class="s2">"feed"</span><span class="p">},</span>
  <span class="p">{</span><span class="ss">title: </span><span class="s2">"RSS Feed"</span><span class="p">})</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= auto_discovery_link_tag(:rss, {action: "feed"},
  {title: "RSS Feed"}) %&gt;
'>Copy</button>
</div>
<p>Hay tres opciones de etiqueta disponibles para el <code>auto_discovery_link_tag</code>:</p>
<ul>
<li>
<code>:rel</code> especifica el valor <code>rel</code> en el enlace. El valor predeterminado es "alternativo".</li>
<li>
<code>:type</code> especifica un tipo MIME explícito. Rails generará un tipo MIME apropiado automáticamente.</li>
<li>
<code>:title</code> especifica el título del enlace. El valor predeterminado es el valor <code>:type</code> en mayúsculas, por ejemplo, "ATOM" o "RSS".</li>
</ul>
<h5 id="linking-to-javascript-files-with-the-javascript-include-tag"><a class="anchorlink" href="#linking-to-javascript-files-with-the-javascript-include-tag">3.1.2 Linking to JavaScript Files with the <code>javascript_include_tag</code></a></h5><p>El ayudante <code>javascript_include_tag</code> devuelve una etiqueta HTML <code>script</code> para cada fuente proporcionada.</p><p>Si está utilizando Rails con <a href="asset_pipeline.html">Asset Pipeline</a>habilitado, este asistente generará un enlace a <code>/assets/javascripts/</code> en lugar de a <code>public/javascripts</code> que se usaba en versiones anteriores de Rails. Este enlace luego es servido por la canalización de activos.</p><p>Un archivo JavaScript dentro de una aplicación Rails o motor Rails va en una de estas tres ubicaciones: <code>app/assets</code>,<code>lib/assets</code> o <code>vendor/assets</code>. Estas ubicaciones se explican en detalle en la <a href="asset_pipeline.html#asset-organization">Asset Organization section in the Asset Pipeline Guide</a>.</p><p>Puede especificar una ruta completa relativa a la raíz del documento, o una URL, si lo prefiere. Por ejemplo, para enlazar a un archivo JavaScript que está dentro de un directorio llamado <code>javascripts</code> dentro de uno de <code>app/assets</code>, <code>lib/assets</code> o <code>vendor/assets</code>, deberías hacer esto:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"main"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= javascript_include_tag "main" %&gt;
'>Copy</button>
</div>
<p>Rails generará una etiqueta <code>script</code> como esta:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">'/assets/main.js'</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;script src='/assets/main.js'&gt;&lt;/script&gt;
">Copy</button>
</div>
<p>Luego, la gem Sprockets atiende la solicitud a este activo.</p><p>Para incluir varios archivos como <code>app/assets/javascripts/main.js</code> y <code>app/assets/javascripts/column.js</code> al mismo tiempo:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"columns"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= javascript_include_tag "main", "columns" %&gt;
'>Copy</button>
</div>
<p>Para incluir <code>app/assets/javascripts/main.js</code> y <code>app/assets/javascripts/photos/columns.js</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"/photos/columns"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= javascript_include_tag "main", "/photos/columns" %&gt;
'>Copy</button>
</div>
<p>Para incluir <code>http://example.com/main.js</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">"http://example.com/main.js"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= javascript_include_tag "http://example.com/main.js" %&gt;
'>Copy</button>
</div>
<h5 id="linking-to-css-files-with-the-stylesheet-link-tag"><a class="anchorlink" href="#linking-to-css-files-with-the-stylesheet-link-tag">3.1.3 Linking to CSS Files with the <code>stylesheet_link_tag</code></a></h5><p>El ayudante <code>stylesheet_link_tag</code> devuelve una etiqueta HTML <code>&lt;link&gt;</code> para cada fuente proporcionada.</p><p>Si está utilizando Rails con el "Asset Pipeline" habilitado, este asistente generará un enlace a <code>/assets/stylesheets/</code>. Este enlace luego es procesado por la gema Sprockets. Un archivo de hoja de estilo se puede almacenar en una de estas tres ubicaciones: <code>app/assets</code>, <code>lib/assets</code> o <code>vendor/assets</code>.</p><p>Puede especificar una ruta completa relativa a la raíz del documento o una URL. Por ejemplo, para vincular a un archivo de hoja de estilo que está dentro de un directorio llamado <code>stylesheets</code> dentro de uno de <code>app/assets</code>, <code>lib/assets</code> o<code>vendor/assets</code>, deberías hacer esto:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= stylesheet_link_tag "main" %&gt;
'>Copy</button>
</div>
<p>Para incluir <code>app/assets/stylesheets/main.css</code> y <code>app/assets/stylesheets/columns.css</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"columns"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= stylesheet_link_tag "main", "columns" %&gt;
'>Copy</button>
</div>
<p>Para incluir <code>app/assets/stylesheets/main.css</code> y <code>app/assets/stylesheets/photos/columns.css</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main"</span><span class="p">,</span> <span class="s2">"photos/columns"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= stylesheet_link_tag "main", "photos/columns" %&gt;
'>Copy</button>
</div>
<p>Para incluir   <code>http://example.com/main.css</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"http://example.com/main.css"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= stylesheet_link_tag "http://example.com/main.css" %&gt;
'>Copy</button>
</div>
<p>De forma predeterminada, la <code>stylesheet_link_tag</code> crea enlaces con<code>media="screen" rel="stylesheet"</code>. Puede anular cualquiera de estos valores predeterminados especificando una opción adecuada (<code>:media</code>,<code>:rel</code>):</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"main_print"</span><span class="p">,</span> <span class="ss">media: </span><span class="s2">"print"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= stylesheet_link_tag "main_print", media: "print" %&gt;
'>Copy</button>
</div>
<h5 id="linking-to-images-with-the-image-tag"><a class="anchorlink" href="#linking-to-images-with-the-image-tag">3.1.4 Linking to Images with the <code>image_tag</code></a></h5><p>El ayudante <code>image_tag</code> crea una etiqueta HTML<code>&lt;img/&gt;</code> en el archivo especificado. Por defecto, los archivos se cargan desde "public/images".</p><div class="warning"><p>Tenga en cuenta que debe especificar la extensión de la imagen.</p></div><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"header.png"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= image_tag "header.png" %&gt;
'>Copy</button>
</div>
<p>Puede proporcionar una ruta a la imagen si lo desea:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"icons/delete.gif"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= image_tag "icons/delete.gif" %&gt;
'>Copy</button>
</div>
<p>Puede proporcionar un hash de opciones HTML adicionales:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"icons/delete.gif"</span><span class="p">,</span> <span class="p">{</span><span class="ss">height: </span><span class="mi">45</span><span class="p">}</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= image_tag "icons/delete.gif", {height: 45} %&gt;
'>Copy</button>
</div>
<p>Puede proporcionar texto alternativo para la imagen que se utilizará si el usuario tiene imágenes desactivadas en su navegador. Si no especifica un texto alternativo explícitamente, el nombre predeterminado del archivo es el del archivo, en mayúsculas y sin extensión. Por ejemplo, estas dos etiquetas de imagen devolverían el mismo código:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span><span class="p">,</span> <span class="ss">alt: </span><span class="s2">"Home"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= image_tag "home.gif" %&gt;
&lt;%= image_tag "home.gif", alt: "Home" %&gt;
'>Copy</button>
</div>
<p>También puede especificar una etiqueta de tamaño especial, en el formato "{ancho} x {alto}":</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span><span class="p">,</span> <span class="ss">size: </span><span class="s2">"50x20"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= image_tag "home.gif", size: "50x20" %&gt;
'>Copy</button>
</div>
<p>Además de las etiquetas especiales anteriores, puede proporcionar un hash final de las opciones HTML estándar, como <code>:class</code>, <code>:id</code> o <code>:name</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">image_tag</span> <span class="s2">"home.gif"</span><span class="p">,</span> <span class="ss">alt: </span><span class="s2">"Go Home"</span><span class="p">,</span>
                          <span class="ss">id: </span><span class="s2">"HomeImage"</span><span class="p">,</span>
                          <span class="ss">class: </span><span class="s2">"nav_bar"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= image_tag "home.gif", alt: "Go Home",
                          id: "HomeImage",
                          class: "nav_bar" %&gt;
'>Copy</button>
</div>
<h5 id="linking-to-videos-with-the-video-tag"><a class="anchorlink" href="#linking-to-videos-with-the-video-tag">3.1.5 Linking to Videos with the <code>video_tag</code></a></h5><p>El ayudante <code>video_tag</code> crea una etiqueta HTML 5 <code>&lt;video&gt;</code> en el archivo especificado. De forma predeterminada, los archivos se cargan desde <code>public/videos</code>.</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">video_tag</span> <span class="s2">"movie.ogg"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= video_tag "movie.ogg" %&gt;
'>Copy</button>
</div>
<p>Produce</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;video</span> <span class="na">src=</span><span class="s">"/videos/movie.ogg"</span> <span class="nt">/&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;video src="/videos/movie.ogg" /&gt;
'>Copy</button>
</div>
<p>Como una <code>image_tag</code>, puede proporcionar una ruta, ya sea absoluta o relativa al directorio <code>public/videos</code>. Además, puede especificar la opción <code>size: "#{width}x#{height}"</code>  como una <code>image_tag</code>. Las etiquetas de video también pueden tener cualquiera de las opciones HTML especificadas al final (<code>id</code>, <code>class</code> et al).</p><p>La etiqueta de video también admite todas las opciones HTML <code>&lt;video&gt;</code> mediante el hash de opciones HTML, que incluyen:</p>
<ul>
<li>
<code>poster:" image_name.png"</code>, proporciona una imagen para colocar en lugar del video antes de que comience a reproducirse.</li>
<li>
<code>autoplay: true</code>, comienza a reproducir el video al cargar la página.</li>
<li>
<code>loop: true</code>, repite el video una vez que llega al final.</li>
<li>
<code>controls: true</code>, proporciona controles proporcionados por el navegador para que el usuario interactúe con el video.</li>
<li>
<code>autobuffer: true</code>, el video precargará el archivo para el usuario al cargar la página.</li>
</ul>
<p>También puede especificar varios videos para reproducir pasando una serie de videos a la etiqueta <code>video_tag</code>:</p><p><code>erb
&lt;%= video_tag ["trailer.ogg", "movie.ogg"] %&gt;
</code>`</p><p>Esto producirá:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;video&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">src=</span><span class="s">"/videos/trailer.ogg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">src=</span><span class="s">"/videos/movie.ogg"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/video&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;video&gt;
  &lt;source src="/videos/trailer.ogg"&gt;
  &lt;source src="/videos/movie.ogg"&gt;
&lt;/video&gt;
'>Copy</button>
</div>
<h5 id="linking-to-audio-files-with-the-audio-tag"><a class="anchorlink" href="#linking-to-audio-files-with-the-audio-tag">3.1.6 Linking to Audio Files with the <code>audio_tag</code></a></h5><p>El ayudante <code>audio_tag</code> crea una etiqueta HTML 5 <code>&lt;audio&gt;</code> en el archivo especificado. De forma predeterminada, los archivos se cargan desde <code>public/audios</code>.</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">audio_tag</span> <span class="s2">"music.mp3"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= audio_tag "music.mp3" %&gt;
'>Copy</button>
</div>
<p>Puede proporcionar una ruta al archivo de audio si lo desea:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">audio_tag</span> <span class="s2">"music/first_song.mp3"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= audio_tag "music/first_song.mp3" %&gt;
'>Copy</button>
</div>
<p>También puede proporcionar un hash de opciones adicionales, como <code>:id</code>,<code>: class</code>, etc.</p><p>Al igual que el <code>video_tag</code>, el <code>audio_tag</code> tiene opciones especiales:</p>
<ul>
<li>
<code>autoplay: true</code>, comienza a reproducir el audio al cargar la página</li>
<li>
<code>controls: true</code>, proporciona controles proporcionados por el navegador para que el usuario interactúe con el audio.</li>
<li>
<code>autobuffer: true</code>, el audio precargará el archivo para el usuario al cargar la página.</li>
</ul>
<h4 id="understanding-yield"><a class="anchorlink" href="#understanding-yield">3.2 Understanding <code>yield</code></a></h4><p>Dentro del contexto de un diseño, <code>yield</code> identifica una sección donde se debe insertar el contenido de la vista. La forma más sencilla de utilizar esto es tener un único "rendimiento", en el que se inserta todo el contenido de la vista que se está renderizando actualmente:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;%= yield %&gt;
  &lt;/body&gt;
&lt;/html&gt;
">Copy</button>
</div>
<p>También puede crear un diseño con varias regiones productivas:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
  <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="ss">:head</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;html&gt;
  &lt;head&gt;
  &lt;%= yield :head %&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;%= yield %&gt;
  &lt;/body&gt;
&lt;/html&gt;
">Copy</button>
</div>
<p>El cuerpo principal de la vista siempre se representará en el <code>yield</code> sin nombre. Para convertir el contenido en un <code>yield</code> con nombre, utiliza el método <code>content_for</code>.</p><h4 id="using-the-content-for-method"><a class="anchorlink" href="#using-the-content-for-method">3.3 Using the <code>content_for</code> Method</a></h4><p>El método <code>content_for</code> le permite insertar contenido en un bloque llamado<code>yield</code> en su diseño. Por ejemplo, esta vista funcionaría con el diseño que acaba de ver:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%</span> <span class="n">content_for</span> <span class="ss">:head</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;title&gt;</span>A simple page<span class="nt">&lt;/title&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>

<span class="nt">&lt;p&gt;</span>Hello, Rails!<span class="nt">&lt;/p&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;% content_for :head do %&gt;
  &lt;title&gt;A simple page&lt;/title&gt;
&lt;% end %&gt;

&lt;p&gt;Hello, Rails!&lt;/p&gt;
">Copy</button>
</div>
<p>El resultado de convertir esta página en el diseño proporcionado sería este HTML:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;title&gt;</span>A simple page<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;p&gt;</span>Hello, Rails!<span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;html&gt;
  &lt;head&gt;
  &lt;title&gt;A simple page&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;p&gt;Hello, Rails!&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
">Copy</button>
</div>
<p>El método <code>content_for</code> es muy útil cuando su diseño contiene regiones distintas, como barras laterales y pies de página, que deben insertar sus propios bloques de contenido. También es útil para insertar etiquetas que cargan archivos JavaScript o css específicos de la página en el encabezado de un diseño genérico.</p><h4 id="using-partials"><a class="anchorlink" href="#using-partials">3.4 Using Partials</a></h4><p>Las plantillas parciales, generalmente llamadas "partials", son otro dispositivo para dividir el proceso de renderizado en partes más manejables. Con un parcial, puede mover el código para representar una parte particular de una respuesta a su propio archivo.</p><h5 id="naming-partials"><a class="anchorlink" href="#naming-partials">3.4.1 Naming Partials</a></h5><p>Para renderizar un parcial como parte de una vista, usa el método <code>render</code> dentro de la vista:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="o">&lt;</span><span class="sx">%= render "menu" %&gt;
</span></code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render "menu" %&gt;
'>Copy</button>
</div>
<p>Esto generará un archivo llamado <code>_menu.html.erb</code> en ese punto dentro de la vista que se está procesando. Tenga en cuenta el carácter de subrayado inicial: los parciales se nombran con un carácter de subrayado inicial para distinguirlos de las vistas normales, aunque se mencionan sin el subrayado. Esto es cierto incluso cuando está extrayendo un parcial de otra carpeta:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="o">&lt;</span><span class="sx">%= render "shared/menu" %&gt;
</span></code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render "shared/menu" %&gt;
'>Copy</button>
</div>
<p>Ese código extraerá el parcial de <code>app/views/shared/_menu.html.erb</code>.</p><h5 id="using-partials-to-simplify-views"><a class="anchorlink" href="#using-partials-to-simplify-views">3.4.2 Using Partials to Simplify Views</a></h5><p>Una forma de usar parciales es tratarlos como el equivalente de subrutinas: como una forma de mover detalles fuera de una vista para que pueda comprender lo que está sucediendo más fácilmente. Por ejemplo, es posible que tenga una vista similar a esta:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s2">"shared/ad_banner"</span> <span class="cp">%&gt;</span>

<span class="nt">&lt;h1&gt;</span>Products<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;p&gt;</span>Here are a few of our fine products:<span class="nt">&lt;/p&gt;</span>
...

<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s2">"shared/footer"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render "shared/ad_banner" %&gt;

&lt;h1&gt;Products&lt;/h1&gt;

&lt;p&gt;Here are a few of our fine products:&lt;/p&gt;
...

&lt;%= render "shared/footer" %&gt;
'>Copy</button>
</div>
<p>Aquí, los parciales <code>_ad_banner.html.erb</code> y <code>_footer.html.erb</code> podrían contener
contenido compartido por muchas páginas de su aplicación. No necesitas ver
los detalles de estas secciones cuando se concentra en una página en particular.</p><p>Como se vio en las secciones anteriores de esta guía, <code>yield</code> es una herramienta muy poderosa
para limpiar sus diseños. Tenga en cuenta que es Ruby puro, por lo que puede usar
casi en todas partes. Por ejemplo, podemos usarlo para SECAR el diseño del formulario
definiciones para varios recursos similares:</p>
<ul>
<li>
<p><code>users/index.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s2">"shared/search_filters"</span><span class="p">,</span> <span class="ss">search: </span><span class="vi">@q</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    Name contains: <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:name_contains</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render "shared/search_filters", search: @q do |form| %&gt;
  &lt;p&gt;
    Name contains: &lt;%= form.text_field :name_contains %&gt;
  &lt;/p&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
</li>
<li>
<p><code>roles/index.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s2">"shared/search_filters"</span><span class="p">,</span> <span class="ss">search: </span><span class="vi">@q</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    Title contains: <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:title_contains</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render "shared/search_filters", search: @q do |form| %&gt;
  &lt;p&gt;
    Title contains: &lt;%= form.text_field :title_contains %&gt;
  &lt;/p&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
</li>
<li>
<p><code>shared/_search_filters.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="n">search</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Search form:<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;fieldset&gt;</span>
    <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="n">form</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/fieldset&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="s2">"Search"</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= form_with model: search do |form| %&gt;
  &lt;h1&gt;Search form:&lt;/h1&gt;
  &lt;fieldset&gt;
    &lt;%= yield form %&gt;
  &lt;/fieldset&gt;
  &lt;p&gt;
    &lt;%= form.submit "Search" %&gt;
  &lt;/p&gt;
&lt;% end %&gt;
'>Copy</button>
</div>
</li>
</ul>
<div class="info"><p>Para el contenido que se comparte entre todas las páginas de su aplicación, puede utilizar parciales directamente desde los diseños.</p></div><h5 id="partial-layouts"><a class="anchorlink" href="#partial-layouts">3.4.3 Partial Layouts</a></h5><p>Un parcial puede usar su propio archivo de diseño, al igual que una vista puede usar un diseño. Por ejemplo, puede llamar a un parcial como este:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"link_area"</span><span class="p">,</span> <span class="ss">layout: </span><span class="s2">"graybar"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render partial: "link_area", layout: "graybar" %&gt;
'>Copy</button>
</div>
<p>Esto buscaría un parcial llamado <code>_link_area.html.erb</code> y lo renderizaría usando el diseño <code>_graybar.html.erb</code>. Tenga en cuenta que los diseños para parciales siguen el mismo nombre de subrayado inicial que los parciales regulares y se colocan en la misma carpeta con el parcial al que pertenecen (no en la carpeta maestra de diseños).</p><p>También tenga en cuenta que se requiere especificar explícitamente <code>:partial</code> cuando se pasan opciones adicionales como<code>:layout</code>.</p><h5 id="passing-local-variables"><a class="anchorlink" href="#passing-local-variables">3.4.4 Passing Local Variables</a></h5><p>También puede pasar variables locales a parciales, haciéndolas aún más poderosas y flexibles. Por ejemplo, puede utilizar esta técnica para reducir la duplicación entre las páginas nuevas y de edición, mientras mantiene un poco de contenido distinto:</p>
<ul>
<li>
<p><code>new.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>New zone<span class="nt">&lt;/h1&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"form"</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span><span class="ss">zone: </span><span class="vi">@zone</span><span class="p">}</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;h1&gt;New zone&lt;/h1&gt;
&lt;%= render partial: "form", locals: {zone: @zone} %&gt;
'>Copy</button>
</div>
</li>
<li>
<p><code>edit.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Editing zone<span class="nt">&lt;/h1&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"form"</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span><span class="ss">zone: </span><span class="vi">@zone</span><span class="p">}</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;h1&gt;Editing zone&lt;/h1&gt;
&lt;%= render partial: "form", locals: {zone: @zone} %&gt;
'>Copy</button>
</div>
</li>
<li>
<p><code>_form.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">form_with</span> <span class="ss">model: </span><span class="n">zone</span> <span class="k">do</span> <span class="o">|</span><span class="n">form</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;b&gt;</span>Zone name<span class="nt">&lt;/b&gt;&lt;br&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
  <span class="nt">&lt;p&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form</span><span class="p">.</span><span class="nf">submit</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= form_with model: zone do |form| %&gt;
  &lt;p&gt;
    &lt;b&gt;Zone name&lt;/b&gt;&lt;br&gt;
    &lt;%= form.text_field :name %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= form.submit %&gt;
  &lt;/p&gt;
&lt;% end %&gt;
">Copy</button>
</div>
<p>Aunque el mismo parcial se representará en ambas vistas, el asistente de envío de la Vista de acción devolverá "Crear zona" para la nueva acción y "Actualizar zona" para la acción de edición.</p>
</li>
</ul>
<p>Para pasar una variable local a un parcial solo en casos específicos, use <code>local_assigns</code>.</p>
<ul>
<li><code>index.html.erb</code></li>
</ul>
<div class="code_container">
<pre><code class="highlight erb">  <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="n">user</span><span class="p">.</span><span class="nf">articles</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="  &lt;%= render user.articles %&gt;
">Copy</button>
</div>

<ul>
<li><code>show.html.erb</code></li>
</ul>
<div class="code_container">
<pre><code class="highlight erb">  <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="n">article</span><span class="p">,</span> <span class="ss">full: </span><span class="kp">true</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="  &lt;%= render article, full: true %&gt;
">Copy</button>
</div>

<ul>
<li><code>_article.html.erb</code></li>
</ul>
<div class="code_container">
<pre><code class="highlight erb">  <span class="nt">&lt;h2&gt;</span><span class="cp">&lt;%=</span> <span class="n">article</span><span class="p">.</span><span class="nf">title</span> <span class="cp">%&gt;</span><span class="nt">&lt;/h2&gt;</span>

  <span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">local_assigns</span><span class="p">[</span><span class="ss">:full</span><span class="p">]</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">simple_format</span> <span class="n">article</span><span class="p">.</span><span class="nf">body</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">else</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">truncate</span> <span class="n">article</span><span class="p">.</span><span class="nf">body</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="  &lt;h2&gt;&lt;%= article.title %&gt;&lt;/h2&gt;

  &lt;% if local_assigns[:full] %&gt;
    &lt;%= simple_format article.body %&gt;
  &lt;% else %&gt;
    &lt;%= truncate article.body %&gt;
  &lt;% end %&gt;
">Copy</button>
</div>
<p>De esta forma es posible utilizar el parcial sin necesidad de declarar todas las variables locales.</p><p>Cada parcial también tiene una variable local con el mismo nombre que el parcial (menos el subrayado inicial). Puede pasar un objeto a esta variable local a través de la opción <code>:object</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"customer"</span><span class="p">,</span> <span class="ss">object: </span><span class="vi">@new_customer</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render partial: "customer", object: @new_customer %&gt;
'>Copy</button>
</div>
<p>Dentro del parcial <code>customer</code>, la variable <code>customer</code> se referirá a <code>@new_customer</code> desde la vista principal.</p><p>Si tiene una instancia de un modelo para convertir en parcial, puede usar una sintaxis abreviada:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@customer</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;%= render @customer %&gt;
">Copy</button>
</div>
<p>Suponiendo que la variable de instancia <code>@customer</code> contiene una instancia del modelo <code>Customer</code>, esto usará <code>_customer.html.erb</code> para representarlo y pasará la variable local <code>customer</code> al parcial que se referirá al ` Variable de instancia de @ customer en la vista principal.</p>
<ul>
<li>
<p><code>index.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Products<span class="nt">&lt;/h1&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;h1&gt;Products&lt;/h1&gt;
&lt;%= render partial: "product", collection: @products %&gt;
'>Copy</button>
</div>
</li>
<li>
<p><code>_product.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;p&gt;</span>Product Name: <span class="cp">&lt;%=</span> <span class="n">product</span><span class="p">.</span><span class="nf">name</span> <span class="cp">%&gt;</span><span class="nt">&lt;/p&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;p&gt;Product Name: &lt;%= product.name %&gt;&lt;/p&gt;
">Copy</button>
</div>
</li>
</ul>
<p>Cuando se llama a un parcial con una colección pluralizada, las instancias individuales del parcial tienen acceso al miembro de la colección que se representa mediante una variable con el nombre del parcial. En este caso, el parcial es <code>_product</code>, y dentro del parcial <code>_product</code>, puede hacer referencia a <code>product</code> para obtener la instancia que se está renderizando.</p><p>También hay una abreviatura para esto. Suponiendo que <code>@products</code> es una colección de instancias de <code>Product</code>, puedes simplemente escribir esto en el <code>index.html.erb</code> para producir el mismo resultado:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Products<span class="nt">&lt;/h1&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="vi">@products</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;h1&gt;Products&lt;/h1&gt;
&lt;%= render @products %&gt;
">Copy</button>
</div>
<p>Rails determina el nombre del parcial a usar mirando el nombre del modelo en la colección. De hecho, incluso puede crear una colección heterogénea y renderizarla de esta manera, y Rails elegirá el parcial adecuado para cada miembro de la colección:</p>
<ul>
<li>
<p><code>index.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Contacts<span class="nt">&lt;/h1&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="p">[</span><span class="n">customer1</span><span class="p">,</span> <span class="n">employee1</span><span class="p">,</span> <span class="n">customer2</span><span class="p">,</span> <span class="n">employee2</span><span class="p">]</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;h1&gt;Contacts&lt;/h1&gt;
&lt;%= render [customer1, employee1, customer2, employee2] %&gt;
">Copy</button>
</div>
</li>
<li>
<p><code>customers/_customer.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;p&gt;</span>Customer: <span class="cp">&lt;%=</span> <span class="n">customer</span><span class="p">.</span><span class="nf">name</span> <span class="cp">%&gt;</span><span class="nt">&lt;/p&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;p&gt;Customer: &lt;%= customer.name %&gt;&lt;/p&gt;
">Copy</button>
</div>
</li>
<li>
<p><code>employees/_employee.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;p&gt;</span>Employee: <span class="cp">&lt;%=</span> <span class="n">employee</span><span class="p">.</span><span class="nf">name</span> <span class="cp">%&gt;</span><span class="nt">&lt;/p&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text="&lt;p&gt;Employee: &lt;%= employee.name %&gt;&lt;/p&gt;
">Copy</button>
</div>
</li>
</ul>
<p>En este caso, Rails utilizará los parciales de cliente o empleado según corresponda para cada miembro de la colección.</p><p>En el caso de que la colección esté vacía, <code>render</code> devolverá nil, por lo que debería ser bastante sencillo proporcionar contenido alternativo.</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;h1&gt;</span>Products<span class="nt">&lt;/h1&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span><span class="p">(</span><span class="vi">@products</span><span class="p">)</span> <span class="o">||</span> <span class="s2">"There are no products available."</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;h1&gt;Products&lt;/h1&gt;
&lt;%= render(@products) || "There are no products available." %&gt;
'>Copy</button>
</div>
<h5 id="local-variables"><a class="anchorlink" href="#local-variables">3.4.5 Local Variables</a></h5><p>Para usar un nombre de variable local personalizado dentro del parcial, especifique la opción <code>:as</code> en la llamada al parcial:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span><span class="p">,</span> <span class="ss">as: :item</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render partial: "product", collection: @products, as: :item %&gt;
'>Copy</button>
</div>
<p>Con este cambio, puede acceder a una instancia de la colección <code>@products</code> como la variable local <code>item</code> dentro del parcial.</p><p>También puede pasar variables locales arbitrarias a cualquier parcial que esté renderizando con la opción <code>locals: {}</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span><span class="p">,</span>
           <span class="ss">as: :item</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span><span class="ss">title: </span><span class="s2">"Products Page"</span><span class="p">}</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render partial: "product", collection: @products,
           as: :item, locals: {title: "Products Page"} %&gt;
'>Copy</button>
</div>
<p>En este caso, el parcial tendrá acceso a una variable local <code>title</code> con el valor" Página de productos ".</p><div class="info"><p>Rails también hace que una variable de contador esté disponible dentro de un parcial llamado por la colección, llamado así por el título del parcial seguido de "<em>counter". Por ejemplo, al renderizar una colección <code>@products</code>, el <code>_product.html.erb</code> parcial puede acceder a la variable <code>product_counter</code> que indexa el número de veces que se ha renderizado dentro de la vista adjunta. Tenga en cuenta que también se aplica cuando se cambió el nombre parcial utilizando la opción <code>as:</code>. Por ejemplo, la variable de contador para el código anterior sería `item</em>counter`.</p></div><p>También puede especificar un segundo parcial para ser renderizado entre instancias del parcial principal usando la opción <code>:spacer_template</code>:</p><h5 id="spacer-templates"><a class="anchorlink" href="#spacer-templates">3.4.6 Spacer Templates</a></h5><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="vi">@products</span><span class="p">,</span> <span class="ss">spacer_template: </span><span class="s2">"product_ruler"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render partial: @products, spacer_template: "product_ruler" %&gt;
'>Copy</button>
</div>
<p>Rails renderizará el <code>_product_ruler</code> parcial (sin que se le pasen datos) entre cada par de parciales de <code>_product</code>.</p><h5 id="collection-partial-layouts"><a class="anchorlink" href="#collection-partial-layouts">3.4.7 Collection Partial Layouts</a></h5><p>Al renderizar colecciones, también es posible usar la opción <code>:layout</code>:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">partial: </span><span class="s2">"product"</span><span class="p">,</span> <span class="ss">collection: </span><span class="vi">@products</span><span class="p">,</span> <span class="ss">layout: </span><span class="s2">"special_layout"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;%= render partial: "product", collection: @products, layout: "special_layout" %&gt;
'>Copy</button>
</div>
<p>El diseño se renderizará junto con el parcial de cada elemento de la colección. Las variables object actual y object_counter también estarán disponibles en el diseño, de la misma manera que están dentro del parcial.</p><h4 id="using-nested-layouts"><a class="anchorlink" href="#using-nested-layouts">3.5 Using Nested Layouts</a></h4><p>Es posible que su aplicación requiera un diseño que difiera ligeramente del diseño de su aplicación normal para admitir un controlador en particular. En lugar de repetir el diseño principal y editarlo, puede lograr esto utilizando diseños anidados (a veces llamados sub-plantillas). Aquí hay un ejemplo:</p><p>Suponga que tiene el siguiente diseño de <code>ApplicationController</code>:</p>
<ul>
<li>
<p><code>app/views/layouts/application.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="vi">@page_title</span> <span class="n">or</span> <span class="s2">"Page Title"</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">"layout"</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;style&gt;</span><span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="ss">:stylesheets</span> <span class="cp">%&gt;</span><span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"top_menu"</span><span class="nt">&gt;</span>Top menu items here<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"menu"</span><span class="nt">&gt;</span>Menu items here<span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span><span class="cp">&lt;%=</span> <span class="n">content_for?</span><span class="p">(</span><span class="ss">:content</span><span class="p">)</span> <span class="p">?</span> <span class="k">yield</span><span class="p">(</span><span class="ss">:content</span><span class="p">)</span> <span class="p">:</span> <span class="k">yield</span> <span class="cp">%&gt;</span><span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;&lt;%= @page_title or "Page Title" %&gt;&lt;/title&gt;
  &lt;%= stylesheet_link_tag "layout" %&gt;
  &lt;style&gt;&lt;%= yield :stylesheets %&gt;&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="top_menu"&gt;Top menu items here&lt;/div&gt;
  &lt;div id="menu"&gt;Menu items here&lt;/div&gt;
  &lt;div id="content"&gt;&lt;%= content_for?(:content) ? yield(:content) : yield %&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
'>Copy</button>
</div>
</li>
</ul>
<p>En las páginas generadas por <code>NewsController</code>, desea ocultar el menú superior y agregar un menú derecho:</p>
<ul>
<li>
<p><code>app/views/layouts/news.html.erb</code></p>
<div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%</span> <span class="n">content_for</span> <span class="ss">:stylesheets</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  #top_menu {display: none}
  #right_menu {float: right; background-color: yellow; color: black}
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="n">content_for</span> <span class="ss">:content</span> <span class="k">do</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"right_menu"</span><span class="nt">&gt;</span>Right menu items here<span class="nt">&lt;/div&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">content_for?</span><span class="p">(</span><span class="ss">:news_content</span><span class="p">)</span> <span class="p">?</span> <span class="k">yield</span><span class="p">(</span><span class="ss">:news_content</span><span class="p">)</span> <span class="p">:</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="ss">template: </span><span class="s2">"layouts/application"</span> <span class="cp">%&gt;</span>
</code></pre>
<button class="clipboard-button" data-clipboard-text='&lt;% content_for :stylesheets do %&gt;
  #top_menu {display: none}
  #right_menu {float: right; background-color: yellow; color: black}
&lt;% end %&gt;
&lt;% content_for :content do %&gt;
  &lt;div id="right_menu"&gt;Right menu items here&lt;/div&gt;
  &lt;%= content_for?(:news_content) ? yield(:news_content) : yield %&gt;
&lt;% end %&gt;
&lt;%= render template: "layouts/application" %&gt;
'>Copy</button>
</div>
</li>
</ul>
<p>Eso es. Las vistas de Noticias usarán el nuevo diseño, ocultando el menú superior y agregando un nuevo menú derecho dentro del div "contenido".</p><p>Hay varias formas de obtener resultados similares con diferentes esquemas de sub-plantillas utilizando esta técnica. Tenga en cuenta que no hay límite en los niveles de anidación. Se puede usar el método <code>ActionView ::render</code> a través de<code>render template: 'layouts/news'</code> para basar un nuevo diseño en el diseño de Noticias. Si está seguro de que no subtemplará el diseño <code>News</code>, puede reemplazar el <code>content_for?(:news_content) ? yield(:news_content) :yield</code> con simplemente <code>yield</code>.</p>

        <h3>Comentarios Sobre el Contenido</h3>
        <p>
          Las guías de rieles se administran y publican en latinadeveloper/railsguides.es en GitHub.
        </p>
        <p>
          Si lee esta guía y encuentra algún texto o código incorrecto que le interese, no dude en enviar una solicitud de extracción en el repositorio anterior.

          Consulte el archivo README en GitHub para saber cómo enviar una solicitud de extracción.
          Please contribute if you see any typos or factual errors.
        </p>

      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a> License</p>
<p>"Rails", "Ruby on Rails", and the Rails logo are trademarks of David Heinemeier Hansson. All rights reserved.</p>

    </div>
  </div>
</body>
</html>
